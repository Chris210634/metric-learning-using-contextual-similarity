0%|          | 0/15 [00:00<?, ?it/s]Namespace(batch_size=128, checkpoint='', dataset='CUB', embedding_size=512, eps=0.05, gamma=0.1, lam=0.4, loss='hybrid', loss_lr=0.001, lr=8e-05, n_epochs=80, neg_margins=0.6, pos_margins=0.75, reg_sim=0.25, root='/scratch/cliao25/CUB_200_2011', start_epoch=0, test_freq=5, testxform='bigtest', trainxform='bigtrain', weight_decay=0.0001)
Compose(
    RandomResizedCrop(size=(256, 256), scale=(0.16, 1), ratio=(0.75, 1.33), interpolation=bilinear)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
Compose(
    Resize(size=288, interpolation=bilinear, max_size=None, antialias=None)
    CenterCrop(size=(256, 256))
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
model will be saved in:  CUB_hybrid_lam_0.4_gamma_0.1_807278.9969448003.pt
epoch 0 G_lr 4e-05 W_lr 8e-05
Shuffling data
There are 100 unique labels
reshuffle took 0.02690577507019043 seconds
/share/pkg.7/pytorch/1.9.0/install/lib/python3.8/site-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)

  7%|▋         | 1/15 [00:03<00:46,  3.30s/it]
 13%|█▎        | 2/15 [00:03<00:19,  1.50s/it]
 20%|██        | 3/15 [00:03<00:11,  1.08it/s]
 27%|██▋       | 4/15 [00:04<00:07,  1.53it/s]
 33%|███▎      | 5/15 [00:04<00:05,  1.99it/s]
 40%|████      | 6/15 [00:04<00:03,  2.42it/s]
 47%|████▋     | 7/15 [00:04<00:02,  2.81it/s]
 53%|█████▎    | 8/15 [00:04<00:02,  3.15it/s]
 60%|██████    | 9/15 [00:05<00:01,  3.42it/s]
 67%|██████▋   | 10/15 [00:05<00:01,  3.64it/s]
 73%|███████▎  | 11/15 [00:05<00:01,  3.80it/s]
 80%|████████  | 12/15 [00:05<00:00,  3.92it/s]
 87%|████████▋ | 13/15 [00:06<00:00,  4.02it/s]
 93%|█████████▎| 14/15 [00:06<00:00,  4.08it/s]
100%|██████████| 15/15 [00:06<00:00,  4.13it/s]
100%|██████████| 15/15 [00:06<00:00,  2.23it/s]

  0%|          | 0/15 [00:00<?, ?it/s]epoch 1 G_lr 4e-05 W_lr 8e-05
Shuffling data
There are 100 unique labels
reshuffle took 0.028361797332763672 seconds
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  7%|▋         | 1/15 [00:02<00:36,  2.63s/it]
 13%|█▎        | 2/15 [00:02<00:15,  1.22s/it]
 20%|██        | 3/15 [00:03<00:09,  1.30it/s]
 27%|██▋       | 4/15 [00:03<00:06,  1.78it/s]
 33%|███▎      | 5/15 [00:03<00:04,  2.25it/s]
 40%|████      | 6/15 [00:03<00:03,  2.68it/s]
 47%|████▋     | 7/15 [00:04<00:02,  3.05it/s]
 53%|█████▎    | 8/15 [00:04<00:02,  3.34it/s]
 60%|██████    | 9/15 [00:04<00:01,  3.57it/s]
 67%|██████▋   | 10/15 [00:04<00:01,  3.75it/s]
 73%|███████▎  | 11/15 [00:04<00:01,  3.89it/s]
 80%|████████  | 12/15 [00:05<00:00,  3.98it/s]
 87%|████████▋ | 13/15 [00:05<00:00,  4.04it/s]
 93%|█████████▎| 14/15 [00:05<00:00,  4.09it/s]
100%|██████████| 15/15 [00:05<00:00,  4.12it/s]
100%|██████████| 15/15 [00:06<00:00,  2.46it/s]

  0%|          | 0/15 [00:00<?, ?it/s]epoch 2 G_lr 4e-05 W_lr 8e-05
Shuffling data
There are 100 unique labels
reshuffle took 0.02831411361694336 seconds
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  7%|▋         | 1/15 [00:02<00:33,  2.37s/it]
 13%|█▎        | 2/15 [00:02<00:14,  1.12s/it]
 20%|██        | 3/15 [00:02<00:08,  1.39it/s]
 27%|██▋       | 4/15 [00:03<00:05,  1.89it/s]
 33%|███▎      | 5/15 [00:03<00:04,  2.35it/s]
 40%|████      | 6/15 [00:03<00:03,  2.76it/s]
 47%|████▋     | 7/15 [00:03<00:02,  3.12it/s]
 53%|█████▎    | 8/15 [00:04<00:02,  3.40it/s]
 60%|██████    | 9/15 [00:04<00:01,  3.62it/s]
 67%|██████▋   | 10/15 [00:04<00:01,  3.78it/s]
 73%|███████▎  | 11/15 [00:04<00:01,  3.90it/s]
 80%|████████  | 12/15 [00:05<00:00,  3.99it/s]
 87%|████████▋ | 13/15 [00:05<00:00,  4.05it/s]
 93%|█████████▎| 14/15 [00:05<00:00,  4.10it/s]
100%|██████████| 15/15 [00:05<00:00,  4.13it/s]
100%|██████████| 15/15 [00:05<00:00,  2.56it/s]

  0%|          | 0/15 [00:00<?, ?it/s]epoch 3 G_lr 4e-05 W_lr 8e-05
Shuffling data
There are 100 unique labels
reshuffle took 0.028639554977416992 seconds
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  7%|▋         | 1/15 [00:02<00:31,  2.25s/it]
 13%|█▎        | 2/15 [00:02<00:13,  1.07s/it]
 20%|██        | 3/15 [00:02<00:08,  1.45it/s]
 27%|██▋       | 4/15 [00:02<00:05,  1.96it/s]
 33%|███▎      | 5/15 [00:03<00:04,  2.42it/s]
 40%|████      | 6/15 [00:03<00:03,  2.83it/s]
 47%|████▋     | 7/15 [00:03<00:02,  3.17it/s]
 53%|█████▎    | 8/15 [00:03<00:02,  3.44it/s]
 60%|██████    | 9/15 [00:04<00:01,  3.64it/s]
 67%|██████▋   | 10/15 [00:04<00:01,  3.79it/s]
 73%|███████▎  | 11/15 [00:04<00:01,  3.90it/s]
 80%|████████  | 12/15 [00:04<00:00,  3.98it/s]
 87%|████████▋ | 13/15 [00:05<00:00,  4.03it/s]
 93%|█████████▎| 14/15 [00:05<00:00,  4.07it/s]
100%|██████████| 15/15 [00:05<00:00,  4.11it/s]
100%|██████████| 15/15 [00:05<00:00,  2.61it/s]

  0%|          | 0/15 [00:00<?, ?it/s]epoch 4 G_lr 4e-05 W_lr 8e-05
Shuffling data
There are 100 unique labels
reshuffle took 0.029421329498291016 seconds
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  7%|▋         | 1/15 [00:02<00:30,  2.19s/it]
 13%|█▎        | 2/15 [00:02<00:17,  1.33s/it]
 20%|██        | 3/15 [00:03<00:09,  1.20it/s]
 27%|██▋       | 4/15 [00:03<00:06,  1.67it/s]
 33%|███▎      | 5/15 [00:03<00:04,  2.14it/s]
 40%|████      | 6/15 [00:03<00:03,  2.57it/s]
 47%|████▋     | 7/15 [00:04<00:02,  2.95it/s]
 53%|█████▎    | 8/15 [00:04<00:02,  3.26it/s]
 60%|██████    | 9/15 [00:04<00:01,  3.51it/s]
 67%|██████▋   | 10/15 [00:04<00:01,  3.70it/s]
 73%|███████▎  | 11/15 [00:05<00:01,  3.84it/s]
 80%|████████  | 12/15 [00:05<00:00,  3.95it/s]
 87%|████████▋ | 13/15 [00:05<00:00,  4.03it/s]
 93%|█████████▎| 14/15 [00:05<00:00,  4.08it/s]
100%|██████████| 15/15 [00:06<00:00,  4.12it/s]
100%|██████████| 15/15 [00:06<00:00,  2.44it/s]Testing there are 5924 samples in testset

[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  0%|          | 0/24 [00:00<?, ?it/s]
100%|██████████| 24/24 [00:00<00:00, 261.17it/s]

  0%|          | 0/15 [00:00<?, ?it/s]torch.Size([5924])
Test R @ 1:  0.6394328156650911
beat test acc, saving model ... 
epoch 5 G_lr 4e-05 W_lr 8e-05
Shuffling data
There are 100 unique labels
reshuffle took 0.02671027183532715 seconds
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  7%|▋         | 1/15 [00:01<00:26,  1.92s/it]
 13%|█▎        | 2/15 [00:02<00:14,  1.12s/it]
 20%|██        | 3/15 [00:02<00:08,  1.40it/s]
 27%|██▋       | 4/15 [00:02<00:05,  1.90it/s]
 33%|███▎      | 5/15 [00:03<00:04,  2.37it/s]
 40%|████      | 6/15 [00:03<00:03,  2.78it/s]
 47%|████▋     | 7/15 [00:03<00:02,  3.13it/s]
 53%|█████▎    | 8/15 [00:03<00:02,  3.40it/s]
 60%|██████    | 9/15 [00:04<00:01,  3.61it/s]
 67%|██████▋   | 10/15 [00:04<00:01,  3.77it/s]
 73%|███████▎  | 11/15 [00:04<00:01,  3.89it/s]
 80%|████████  | 12/15 [00:04<00:00,  3.97it/s]
 87%|████████▋ | 13/15 [00:05<00:00,  4.03it/s]
 93%|█████████▎| 14/15 [00:05<00:00,  4.08it/s]
100%|██████████| 15/15 [00:05<00:00,  4.11it/s]
100%|██████████| 15/15 [00:05<00:00,  2.62it/s]

  0%|          | 0/15 [00:00<?, ?it/s]epoch 6 G_lr 4e-05 W_lr 8e-05
Shuffling data
There are 100 unique labels
reshuffle took 0.03450274467468262 seconds
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  7%|▋         | 1/15 [00:02<00:33,  2.37s/it]
 13%|█▎        | 2/15 [00:02<00:14,  1.11s/it]
 20%|██        | 3/15 [00:02<00:08,  1.40it/s]
 27%|██▋       | 4/15 [00:03<00:05,  1.90it/s]
 33%|███▎      | 5/15 [00:03<00:04,  2.36it/s]
 40%|████      | 6/15 [00:03<00:03,  2.77it/s]
 47%|████▋     | 7/15 [00:03<00:02,  3.12it/s]
 53%|█████▎    | 8/15 [00:04<00:02,  3.40it/s]
 60%|██████    | 9/15 [00:04<00:01,  3.62it/s]
 67%|██████▋   | 10/15 [00:04<00:01,  3.78it/s]
 73%|███████▎  | 11/15 [00:04<00:01,  3.91it/s]
 80%|████████  | 12/15 [00:04<00:00,  3.99it/s]
 87%|████████▋ | 13/15 [00:05<00:00,  4.06it/s]
 93%|█████████▎| 14/15 [00:05<00:00,  4.10it/s]
100%|██████████| 15/15 [00:05<00:00,  4.13it/s]
100%|██████████| 15/15 [00:05<00:00,  2.57it/s]

  0%|          | 0/15 [00:00<?, ?it/s]epoch 7 G_lr 4e-05 W_lr 8e-05
Shuffling data
There are 100 unique labels
reshuffle took 0.028130054473876953 seconds
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  7%|▋         | 1/15 [00:01<00:26,  1.90s/it]
 13%|█▎        | 2/15 [00:02<00:11,  1.08it/s]
 20%|██        | 3/15 [00:02<00:08,  1.37it/s]
 27%|██▋       | 4/15 [00:02<00:05,  1.87it/s]
 33%|███▎      | 5/15 [00:03<00:04,  2.33it/s]
 40%|████      | 6/15 [00:03<00:03,  2.74it/s]
 47%|████▋     | 7/15 [00:03<00:02,  3.09it/s]
 53%|█████▎    | 8/15 [00:03<00:02,  3.36it/s]
 60%|██████    | 9/15 [00:04<00:01,  3.58it/s]
 67%|██████▋   | 10/15 [00:04<00:01,  3.74it/s]
 73%|███████▎  | 11/15 [00:04<00:01,  3.86it/s]
 80%|████████  | 12/15 [00:04<00:00,  3.93it/s]
 87%|████████▋ | 13/15 [00:05<00:00,  3.99it/s]
 93%|█████████▎| 14/15 [00:05<00:00,  4.03it/s]
100%|██████████| 15/15 [00:05<00:00,  4.06it/s]
100%|██████████| 15/15 [00:05<00:00,  2.64it/s]

  0%|          | 0/15 [00:00<?, ?it/s]epoch 8 G_lr 4e-05 W_lr 8e-05
Shuffling data
There are 100 unique labels
reshuffle took 0.029158353805541992 seconds
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  7%|▋         | 1/15 [00:03<00:46,  3.31s/it]
 13%|█▎        | 2/15 [00:03<00:19,  1.51s/it]
 20%|██        | 3/15 [00:03<00:11,  1.08it/s]
 27%|██▋       | 4/15 [00:04<00:07,  1.52it/s]
 33%|███▎      | 5/15 [00:04<00:05,  1.98it/s]
 40%|████      | 6/15 [00:04<00:03,  2.41it/s]
 47%|████▋     | 7/15 [00:04<00:02,  2.80it/s]
 53%|█████▎    | 8/15 [00:04<00:02,  3.12it/s]
 60%|██████    | 9/15 [00:05<00:01,  3.39it/s]
 67%|██████▋   | 10/15 [00:05<00:01,  3.60it/s]
 73%|███████▎  | 11/15 [00:05<00:01,  3.77it/s]
 80%|████████  | 12/15 [00:05<00:00,  3.89it/s]
 87%|████████▋ | 13/15 [00:06<00:00,  3.98it/s]
 93%|█████████▎| 14/15 [00:06<00:00,  4.05it/s]
100%|██████████| 15/15 [00:06<00:00,  4.10it/s]
100%|██████████| 15/15 [00:06<00:00,  2.20it/s]

  0%|          | 0/15 [00:00<?, ?it/s]epoch 9 G_lr 4e-05 W_lr 8e-05
Shuffling data
There are 100 unique labels
reshuffle took 0.029721975326538086 seconds
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  7%|▋         | 1/15 [00:02<00:28,  2.06s/it]
 13%|█▎        | 2/15 [00:02<00:12,  1.01it/s]
 20%|██        | 3/15 [00:02<00:08,  1.48it/s]
 27%|██▋       | 4/15 [00:02<00:05,  1.99it/s]
 33%|███▎      | 5/15 [00:03<00:04,  2.46it/s]
 40%|████      | 6/15 [00:03<00:03,  2.86it/s]
 47%|████▋     | 7/15 [00:03<00:02,  3.20it/s]
 53%|█████▎    | 8/15 [00:03<00:02,  3.47it/s]
 60%|██████    | 9/15 [00:04<00:01,  3.67it/s]
 67%|██████▋   | 10/15 [00:04<00:01,  3.81it/s]
 73%|███████▎  | 11/15 [00:04<00:01,  3.93it/s]
 80%|████████  | 12/15 [00:04<00:00,  4.01it/s]
 87%|████████▋ | 13/15 [00:04<00:00,  4.07it/s]
 93%|█████████▎| 14/15 [00:05<00:00,  4.11it/s]
100%|██████████| 15/15 [00:05<00:00,  4.13it/s]
100%|██████████| 15/15 [00:05<00:00,  2.68it/s]Testing there are 5924 samples in testset

[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  0%|          | 0/24 [00:00<?, ?it/s]
100%|██████████| 24/24 [00:00<00:00, 247.89it/s]

  0%|          | 0/15 [00:00<?, ?it/s]torch.Size([5924])
Test R @ 1:  0.6529372045914922
beat test acc, saving model ... 
epoch 10 G_lr 4e-05 W_lr 8e-05
Shuffling data
There are 100 unique labels
reshuffle took 0.02876758575439453 seconds
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  7%|▋         | 1/15 [00:01<00:27,  1.96s/it]
 13%|█▎        | 2/15 [00:02<00:12,  1.04it/s]
 20%|██        | 3/15 [00:02<00:07,  1.59it/s]
 27%|██▋       | 4/15 [00:02<00:05,  2.11it/s]
 33%|███▎      | 5/15 [00:02<00:03,  2.57it/s]
 40%|████      | 6/15 [00:03<00:03,  2.96it/s]
 47%|████▋     | 7/15 [00:03<00:02,  3.28it/s]
 53%|█████▎    | 8/15 [00:03<00:01,  3.52it/s]
 60%|██████    | 9/15 [00:03<00:01,  3.70it/s]
 67%|██████▋   | 10/15 [00:04<00:01,  3.83it/s]
 73%|███████▎  | 11/15 [00:04<00:01,  3.93it/s]
 80%|████████  | 12/15 [00:04<00:00,  4.01it/s]
 87%|████████▋ | 13/15 [00:04<00:00,  4.07it/s]
 93%|█████████▎| 14/15 [00:05<00:00,  4.11it/s]
100%|██████████| 15/15 [00:05<00:00,  4.13it/s]
100%|██████████| 15/15 [00:05<00:00,  2.75it/s]

  0%|          | 0/15 [00:00<?, ?it/s]epoch 11 G_lr 4e-05 W_lr 8e-05
Shuffling data
There are 100 unique labels
reshuffle took 0.0284273624420166 seconds
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  7%|▋         | 1/15 [00:02<00:35,  2.55s/it]
 13%|█▎        | 2/15 [00:02<00:15,  1.19s/it]
 20%|██        | 3/15 [00:03<00:09,  1.32it/s]
 27%|██▋       | 4/15 [00:03<00:06,  1.80it/s]
 33%|███▎      | 5/15 [00:03<00:04,  2.27it/s]
 40%|████      | 6/15 [00:03<00:03,  2.68it/s]
 47%|████▋     | 7/15 [00:03<00:02,  3.03it/s]
 53%|█████▎    | 8/15 [00:04<00:02,  3.32it/s]
 60%|██████    | 9/15 [00:04<00:01,  3.55it/s]
 67%|██████▋   | 10/15 [00:04<00:01,  3.72it/s]
 73%|███████▎  | 11/15 [00:04<00:01,  3.85it/s]
 80%|████████  | 12/15 [00:05<00:00,  3.94it/s]
 87%|████████▋ | 13/15 [00:05<00:00,  4.01it/s]
 93%|█████████▎| 14/15 [00:05<00:00,  4.06it/s]
100%|██████████| 15/15 [00:05<00:00,  4.09it/s]
100%|██████████| 15/15 [00:06<00:00,  2.48it/s]

  0%|          | 0/15 [00:00<?, ?it/s]epoch 12 G_lr 4e-05 W_lr 8e-05
Shuffling data
There are 100 unique labels
reshuffle took 0.02833724021911621 seconds
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  7%|▋         | 1/15 [00:02<00:28,  2.04s/it]
 13%|█▎        | 2/15 [00:02<00:12,  1.01it/s]
 20%|██        | 3/15 [00:02<00:07,  1.53it/s]
 27%|██▋       | 4/15 [00:02<00:05,  2.04it/s]
 33%|███▎      | 5/15 [00:03<00:04,  2.50it/s]
 40%|████      | 6/15 [00:03<00:03,  2.89it/s]
 47%|████▋     | 7/15 [00:03<00:02,  3.19it/s]
 53%|█████▎    | 8/15 [00:03<00:02,  3.45it/s]
 60%|██████    | 9/15 [00:03<00:01,  3.66it/s]
 67%|██████▋   | 10/15 [00:04<00:01,  3.81it/s]
 73%|███████▎  | 11/15 [00:04<00:01,  3.91it/s]
 80%|████████  | 12/15 [00:04<00:00,  4.00it/s]
 87%|████████▋ | 13/15 [00:04<00:00,  4.03it/s]
 93%|█████████▎| 14/15 [00:05<00:00,  4.05it/s]
100%|██████████| 15/15 [00:05<00:00,  4.09it/s]
100%|██████████| 15/15 [00:05<00:00,  2.70it/s]

  0%|          | 0/15 [00:00<?, ?it/s]epoch 13 G_lr 4e-05 W_lr 8e-05
Shuffling data
There are 100 unique labels
reshuffle took 0.028633594512939453 seconds
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  7%|▋         | 1/15 [00:02<00:32,  2.35s/it]
 13%|█▎        | 2/15 [00:02<00:16,  1.24s/it]
 20%|██        | 3/15 [00:03<00:09,  1.27it/s]
 27%|██▋       | 4/15 [00:03<00:06,  1.75it/s]
 33%|███▎      | 5/15 [00:03<00:04,  2.22it/s]
 40%|████      | 6/15 [00:03<00:03,  2.63it/s]
 47%|████▋     | 7/15 [00:04<00:02,  2.99it/s]
 53%|█████▎    | 8/15 [00:04<00:02,  3.29it/s]
 60%|██████    | 9/15 [00:04<00:01,  3.52it/s]
 67%|██████▋   | 10/15 [00:04<00:01,  3.71it/s]
 73%|███████▎  | 11/15 [00:04<00:01,  3.85it/s]
 80%|████████  | 12/15 [00:05<00:00,  3.95it/s]
 87%|████████▋ | 13/15 [00:05<00:00,  4.03it/s]
 93%|█████████▎| 14/15 [00:05<00:00,  4.08it/s]
100%|██████████| 15/15 [00:05<00:00,  4.12it/s]
100%|██████████| 15/15 [00:06<00:00,  2.48it/s]

  0%|          | 0/15 [00:00<?, ?it/s]epoch 14 G_lr 4e-05 W_lr 8e-05
Shuffling data
There are 100 unique labels
reshuffle took 0.0284426212310791 seconds
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  7%|▋         | 1/15 [00:02<00:29,  2.09s/it]
 13%|█▎        | 2/15 [00:02<00:15,  1.19s/it]
 20%|██        | 3/15 [00:02<00:09,  1.33it/s]
 27%|██▋       | 4/15 [00:03<00:06,  1.82it/s]
 33%|███▎      | 5/15 [00:03<00:04,  2.28it/s]
 40%|████      | 6/15 [00:03<00:03,  2.69it/s]
 47%|████▋     | 7/15 [00:03<00:02,  3.05it/s]
 53%|█████▎    | 8/15 [00:04<00:02,  3.34it/s]
 60%|██████    | 9/15 [00:04<00:01,  3.57it/s]
 67%|██████▋   | 10/15 [00:04<00:01,  3.74it/s]
 73%|███████▎  | 11/15 [00:04<00:01,  3.87it/s]
 80%|████████  | 12/15 [00:05<00:00,  3.96it/s]
 87%|████████▋ | 13/15 [00:05<00:00,  4.02it/s]
 93%|█████████▎| 14/15 [00:05<00:00,  4.07it/s]
100%|██████████| 15/15 [00:05<00:00,  4.09it/s]
100%|██████████| 15/15 [00:05<00:00,  2.54it/s]Testing there are 5924 samples in testset

[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  0%|          | 0/24 [00:00<?, ?it/s]
100%|██████████| 24/24 [00:00<00:00, 270.59it/s]

  0%|          | 0/15 [00:00<?, ?it/s]torch.Size([5924])
Test R @ 1:  0.6578325455773126
beat test acc, saving model ... 
epoch 15 G_lr 1.2e-05 W_lr 2.4e-05
Shuffling data
There are 100 unique labels
reshuffle took 0.027092933654785156 seconds
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  7%|▋         | 1/15 [00:02<00:34,  2.44s/it]
 13%|█▎        | 2/15 [00:02<00:14,  1.14s/it]
 20%|██        | 3/15 [00:02<00:08,  1.37it/s]
 27%|██▋       | 4/15 [00:03<00:05,  1.85it/s]
 33%|███▎      | 5/15 [00:03<00:04,  2.31it/s]
 40%|████      | 6/15 [00:03<00:03,  2.72it/s]
 47%|████▋     | 7/15 [00:03<00:02,  3.06it/s]
 53%|█████▎    | 8/15 [00:04<00:02,  3.33it/s]
 60%|██████    | 9/15 [00:04<00:01,  3.55it/s]
 67%|██████▋   | 10/15 [00:04<00:01,  3.71it/s]
 73%|███████▎  | 11/15 [00:04<00:01,  3.83it/s]
 80%|████████  | 12/15 [00:05<00:00,  3.91it/s]
 87%|████████▋ | 13/15 [00:05<00:00,  3.97it/s]
 93%|█████████▎| 14/15 [00:05<00:00,  3.98it/s]
100%|██████████| 15/15 [00:05<00:00,  3.95it/s]
100%|██████████| 15/15 [00:06<00:00,  2.49it/s]

  0%|          | 0/15 [00:00<?, ?it/s]epoch 16 G_lr 1.2e-05 W_lr 2.4e-05
Shuffling data
There are 100 unique labels
reshuffle took 0.030935049057006836 seconds
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  7%|▋         | 1/15 [00:02<00:38,  2.76s/it]
 13%|█▎        | 2/15 [00:03<00:18,  1.45s/it]
 20%|██        | 3/15 [00:03<00:10,  1.12it/s]
 27%|██▋       | 4/15 [00:03<00:07,  1.57it/s]
 33%|███▎      | 5/15 [00:04<00:04,  2.03it/s]
 40%|████      | 6/15 [00:04<00:03,  2.46it/s]
 47%|████▋     | 7/15 [00:04<00:02,  2.84it/s]
 53%|█████▎    | 8/15 [00:04<00:02,  3.16it/s]
 60%|██████    | 9/15 [00:04<00:01,  3.41it/s]
 67%|██████▋   | 10/15 [00:05<00:01,  3.62it/s]
 73%|███████▎  | 11/15 [00:05<00:01,  3.77it/s]
 80%|████████  | 12/15 [00:05<00:00,  3.88it/s]
 87%|████████▋ | 13/15 [00:05<00:00,  3.97it/s]
 93%|█████████▎| 14/15 [00:06<00:00,  4.03it/s]
100%|██████████| 15/15 [00:06<00:00,  4.05it/s]
100%|██████████| 15/15 [00:06<00:00,  2.28it/s]

  0%|          | 0/15 [00:00<?, ?it/s]epoch 17 G_lr 1.2e-05 W_lr 2.4e-05
Shuffling data
There are 100 unique labels
reshuffle took 0.028562545776367188 seconds
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  7%|▋         | 1/15 [00:02<00:39,  2.84s/it]
 13%|█▎        | 2/15 [00:03<00:17,  1.31s/it]
 20%|██        | 3/15 [00:03<00:09,  1.22it/s]
 27%|██▋       | 4/15 [00:03<00:06,  1.69it/s]
 33%|███▎      | 5/15 [00:03<00:04,  2.16it/s]
 40%|████      | 6/15 [00:04<00:03,  2.59it/s]
 47%|████▋     | 7/15 [00:04<00:02,  2.96it/s]
 53%|█████▎    | 8/15 [00:04<00:02,  3.27it/s]
 60%|██████    | 9/15 [00:04<00:01,  3.51it/s]
 67%|██████▋   | 10/15 [00:04<00:01,  3.68it/s]
 73%|███████▎  | 11/15 [00:05<00:01,  3.81it/s]
 80%|████████  | 12/15 [00:05<00:00,  3.91it/s]
 87%|████████▋ | 13/15 [00:05<00:00,  3.98it/s]
 93%|█████████▎| 14/15 [00:05<00:00,  4.05it/s]
100%|██████████| 15/15 [00:06<00:00,  4.09it/s]
100%|██████████| 15/15 [00:06<00:00,  2.38it/s]

  0%|          | 0/15 [00:00<?, ?it/s]epoch 18 G_lr 1.2e-05 W_lr 2.4e-05
Shuffling data
There are 100 unique labels
reshuffle took 0.027924060821533203 seconds
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  7%|▋         | 1/15 [00:02<00:31,  2.23s/it]
 13%|█▎        | 2/15 [00:02<00:13,  1.06s/it]
 20%|██        | 3/15 [00:02<00:08,  1.45it/s]
 27%|██▋       | 4/15 [00:02<00:05,  1.95it/s]
 33%|███▎      | 5/15 [00:03<00:04,  2.41it/s]
 40%|████      | 6/15 [00:03<00:03,  2.79it/s]
 47%|████▋     | 7/15 [00:03<00:02,  3.13it/s]
 53%|█████▎    | 8/15 [00:03<00:02,  3.40it/s]
 60%|██████    | 9/15 [00:04<00:01,  3.60it/s]
 67%|██████▋   | 10/15 [00:04<00:01,  3.75it/s]
 73%|███████▎  | 11/15 [00:04<00:01,  3.87it/s]
 80%|████████  | 12/15 [00:04<00:00,  3.95it/s]
 87%|████████▋ | 13/15 [00:05<00:00,  4.01it/s]
 93%|█████████▎| 14/15 [00:05<00:00,  4.05it/s]
100%|██████████| 15/15 [00:05<00:00,  4.07it/s]
100%|██████████| 15/15 [00:05<00:00,  2.60it/s]

  0%|          | 0/15 [00:00<?, ?it/s]epoch 19 G_lr 1.2e-05 W_lr 2.4e-05
Shuffling data
There are 100 unique labels
reshuffle took 0.028162240982055664 seconds
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  7%|▋         | 1/15 [00:02<00:28,  2.04s/it]
 13%|█▎        | 2/15 [00:02<00:14,  1.09s/it]
 20%|██        | 3/15 [00:02<00:08,  1.42it/s]
 27%|██▋       | 4/15 [00:02<00:05,  1.92it/s]
 33%|███▎      | 5/15 [00:03<00:04,  2.39it/s]
 40%|████      | 6/15 [00:03<00:03,  2.80it/s]
 47%|████▋     | 7/15 [00:03<00:02,  3.14it/s]
 53%|█████▎    | 8/15 [00:03<00:02,  3.41it/s]
 60%|██████    | 9/15 [00:04<00:01,  3.61it/s]
 67%|██████▋   | 10/15 [00:04<00:01,  3.77it/s]
 73%|███████▎  | 11/15 [00:04<00:01,  3.89it/s]
 80%|████████  | 12/15 [00:04<00:00,  3.98it/s]
 87%|████████▋ | 13/15 [00:05<00:00,  4.03it/s]
 93%|█████████▎| 14/15 [00:05<00:00,  4.08it/s]
100%|██████████| 15/15 [00:05<00:00,  4.11it/s]
100%|██████████| 15/15 [00:05<00:00,  2.63it/s]Testing there are 5924 samples in testset

[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  0%|          | 0/24 [00:00<?, ?it/s]
100%|██████████| 24/24 [00:00<00:00, 264.35it/s]

  0%|          | 0/15 [00:00<?, ?it/s]torch.Size([5924])
Test R @ 1:  0.6765698852126941
beat test acc, saving model ... 
epoch 20 G_lr 1.2e-05 W_lr 2.4e-05
Shuffling data
There are 100 unique labels
reshuffle took 0.027184724807739258 seconds
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  7%|▋         | 1/15 [00:02<00:33,  2.42s/it]
 13%|█▎        | 2/15 [00:02<00:14,  1.14s/it]
 20%|██        | 3/15 [00:02<00:08,  1.37it/s]
 27%|██▋       | 4/15 [00:03<00:05,  1.87it/s]
 33%|███▎      | 5/15 [00:03<00:04,  2.33it/s]
 40%|████      | 6/15 [00:03<00:03,  2.74it/s]
 47%|████▋     | 7/15 [00:03<00:02,  3.09it/s]
 53%|█████▎    | 8/15 [00:04<00:02,  3.36it/s]
 60%|██████    | 9/15 [00:04<00:01,  3.58it/s]
 67%|██████▋   | 10/15 [00:04<00:01,  3.75it/s]
 73%|███████▎  | 11/15 [00:04<00:01,  3.88it/s]
 80%|████████  | 12/15 [00:05<00:00,  3.97it/s]
 87%|████████▋ | 13/15 [00:05<00:00,  4.03it/s]
 93%|█████████▎| 14/15 [00:05<00:00,  4.06it/s]
100%|██████████| 15/15 [00:05<00:00,  4.09it/s]
100%|██████████| 15/15 [00:05<00:00,  2.53it/s]

  0%|          | 0/15 [00:00<?, ?it/s]epoch 21 G_lr 1.2e-05 W_lr 2.4e-05
Shuffling data
There are 100 unique labels
reshuffle took 0.02941751480102539 seconds
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  7%|▋         | 1/15 [00:02<00:34,  2.43s/it]
 13%|█▎        | 2/15 [00:02<00:14,  1.15s/it]
 20%|██        | 3/15 [00:02<00:08,  1.36it/s]
 27%|██▋       | 4/15 [00:03<00:05,  1.86it/s]
 33%|███▎      | 5/15 [00:03<00:04,  2.33it/s]
 40%|████      | 6/15 [00:03<00:03,  2.74it/s]
 47%|████▋     | 7/15 [00:03<00:02,  3.09it/s]
 53%|█████▎    | 8/15 [00:04<00:02,  3.38it/s]
 60%|██████    | 9/15 [00:04<00:01,  3.60it/s]
 67%|██████▋   | 10/15 [00:04<00:01,  3.76it/s]
 73%|███████▎  | 11/15 [00:04<00:01,  3.88it/s]
 80%|████████  | 12/15 [00:05<00:00,  3.96it/s]
 87%|████████▋ | 13/15 [00:05<00:00,  4.03it/s]
 93%|█████████▎| 14/15 [00:05<00:00,  4.08it/s]
100%|██████████| 15/15 [00:05<00:00,  4.11it/s]
100%|██████████| 15/15 [00:05<00:00,  2.54it/s]

  0%|          | 0/15 [00:00<?, ?it/s]epoch 22 G_lr 1.2e-05 W_lr 2.4e-05
Shuffling data
There are 100 unique labels
reshuffle took 0.027826786041259766 seconds
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  7%|▋         | 1/15 [00:02<00:30,  2.17s/it]
 13%|█▎        | 2/15 [00:02<00:15,  1.16s/it]
 20%|██        | 3/15 [00:02<00:08,  1.36it/s]
 27%|██▋       | 4/15 [00:03<00:05,  1.85it/s]
 33%|███▎      | 5/15 [00:03<00:04,  2.29it/s]
 40%|████      | 6/15 [00:03<00:03,  2.71it/s]
 47%|████▋     | 7/15 [00:03<00:02,  3.06it/s]
 53%|█████▎    | 8/15 [00:04<00:02,  3.34it/s]
 60%|██████    | 9/15 [00:04<00:01,  3.56it/s]
 67%|██████▋   | 10/15 [00:04<00:01,  3.73it/s]
 73%|███████▎  | 11/15 [00:04<00:01,  3.85it/s]
 80%|████████  | 12/15 [00:05<00:00,  3.95it/s]
 87%|████████▋ | 13/15 [00:05<00:00,  4.02it/s]
 93%|█████████▎| 14/15 [00:05<00:00,  4.07it/s]
100%|██████████| 15/15 [00:05<00:00,  4.10it/s]
100%|██████████| 15/15 [00:05<00:00,  2.55it/s]

  0%|          | 0/15 [00:00<?, ?it/s]epoch 23 G_lr 1.2e-05 W_lr 2.4e-05
Shuffling data
There are 100 unique labels
reshuffle took 0.028977632522583008 seconds
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  7%|▋         | 1/15 [00:01<00:27,  1.99s/it]
 13%|█▎        | 2/15 [00:02<00:14,  1.13s/it]
 20%|██        | 3/15 [00:02<00:08,  1.39it/s]
 27%|██▋       | 4/15 [00:02<00:05,  1.88it/s]
 33%|███▎      | 5/15 [00:03<00:04,  2.35it/s]
 40%|████      | 6/15 [00:03<00:03,  2.77it/s]
 47%|████▋     | 7/15 [00:03<00:02,  3.12it/s]
 53%|█████▎    | 8/15 [00:03<00:02,  3.40it/s]
 60%|██████    | 9/15 [00:04<00:01,  3.62it/s]
 67%|██████▋   | 10/15 [00:04<00:01,  3.78it/s]
 73%|███████▎  | 11/15 [00:04<00:01,  3.90it/s]
 80%|████████  | 12/15 [00:04<00:00,  3.98it/s]
 87%|████████▋ | 13/15 [00:05<00:00,  4.03it/s]
 93%|█████████▎| 14/15 [00:05<00:00,  4.07it/s]
100%|██████████| 15/15 [00:05<00:00,  4.10it/s]
100%|██████████| 15/15 [00:05<00:00,  2.60it/s]

  0%|          | 0/15 [00:00<?, ?it/s]epoch 24 G_lr 1.2e-05 W_lr 2.4e-05
Shuffling data
There are 100 unique labels
reshuffle took 0.028181076049804688 seconds
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  7%|▋         | 1/15 [00:02<00:32,  2.35s/it]
 13%|█▎        | 2/15 [00:02<00:14,  1.12s/it]
 20%|██        | 3/15 [00:02<00:08,  1.39it/s]
 27%|██▋       | 4/15 [00:03<00:05,  1.87it/s]
 33%|███▎      | 5/15 [00:03<00:04,  2.32it/s]
 40%|████      | 6/15 [00:03<00:03,  2.71it/s]
 47%|████▋     | 7/15 [00:03<00:02,  3.05it/s]
 53%|█████▎    | 8/15 [00:04<00:02,  3.33it/s]
 60%|██████    | 9/15 [00:04<00:01,  3.54it/s]
 67%|██████▋   | 10/15 [00:04<00:01,  3.68it/s]
 73%|███████▎  | 11/15 [00:04<00:01,  3.81it/s]
 80%|████████  | 12/15 [00:05<00:00,  3.91it/s]
 87%|████████▋ | 13/15 [00:05<00:00,  3.98it/s]
 93%|█████████▎| 14/15 [00:05<00:00,  4.04it/s]
100%|██████████| 15/15 [00:05<00:00,  4.07it/s]
100%|██████████| 15/15 [00:05<00:00,  2.52it/s]Testing there are 5924 samples in testset

[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  0%|          | 0/24 [00:00<?, ?it/s]
100%|██████████| 24/24 [00:00<00:00, 243.44it/s]

  0%|          | 0/15 [00:00<?, ?it/s]torch.Size([5924])
Test R @ 1:  0.6828156650911547
beat test acc, saving model ... 
epoch 25 G_lr 1.2e-05 W_lr 2.4e-05
Shuffling data
There are 100 unique labels
reshuffle took 0.026948213577270508 seconds
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  7%|▋         | 1/15 [00:02<00:35,  2.54s/it]
 13%|█▎        | 2/15 [00:02<00:15,  1.19s/it]
 20%|██        | 3/15 [00:03<00:09,  1.32it/s]
 27%|██▋       | 4/15 [00:03<00:06,  1.81it/s]
 33%|███▎      | 5/15 [00:03<00:04,  2.28it/s]
 40%|████      | 6/15 [00:03<00:03,  2.70it/s]
 47%|████▋     | 7/15 [00:03<00:02,  3.06it/s]
 53%|█████▎    | 8/15 [00:04<00:02,  3.34it/s]
 60%|██████    | 9/15 [00:04<00:01,  3.57it/s]
 67%|██████▋   | 10/15 [00:04<00:01,  3.74it/s]
 73%|███████▎  | 11/15 [00:04<00:01,  3.88it/s]
 80%|████████  | 12/15 [00:05<00:00,  3.98it/s]
 87%|████████▋ | 13/15 [00:05<00:00,  4.05it/s]
 93%|█████████▎| 14/15 [00:05<00:00,  4.10it/s]
100%|██████████| 15/15 [00:05<00:00,  4.13it/s]
100%|██████████| 15/15 [00:06<00:00,  2.49it/s]

  0%|          | 0/15 [00:00<?, ?it/s]epoch 26 G_lr 1.2e-05 W_lr 2.4e-05
Shuffling data
There are 100 unique labels
reshuffle took 0.02998518943786621 seconds
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  7%|▋         | 1/15 [00:02<00:28,  2.00s/it]
 13%|█▎        | 2/15 [00:02<00:12,  1.03it/s]
 20%|██        | 3/15 [00:02<00:07,  1.51it/s]
 27%|██▋       | 4/15 [00:02<00:05,  2.01it/s]
 33%|███▎      | 5/15 [00:03<00:04,  2.48it/s]
 40%|████      | 6/15 [00:03<00:03,  2.87it/s]
 47%|████▋     | 7/15 [00:03<00:02,  3.20it/s]
 53%|█████▎    | 8/15 [00:03<00:02,  3.46it/s]
 60%|██████    | 9/15 [00:03<00:01,  3.65it/s]
 67%|██████▋   | 10/15 [00:04<00:01,  3.81it/s]
 73%|███████▎  | 11/15 [00:04<00:01,  3.92it/s]
 80%|████████  | 12/15 [00:04<00:00,  4.00it/s]
 87%|████████▋ | 13/15 [00:04<00:00,  4.06it/s]
 93%|█████████▎| 14/15 [00:05<00:00,  4.11it/s]
100%|██████████| 15/15 [00:05<00:00,  4.14it/s]
100%|██████████| 15/15 [00:05<00:00,  2.71it/s]

  0%|          | 0/15 [00:00<?, ?it/s]epoch 27 G_lr 1.2e-05 W_lr 2.4e-05
Shuffling data
There are 100 unique labels
reshuffle took 0.02882242202758789 seconds
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  7%|▋         | 1/15 [00:02<00:31,  2.24s/it]
 13%|█▎        | 2/15 [00:02<00:13,  1.06s/it]
 20%|██        | 3/15 [00:02<00:08,  1.46it/s]
 27%|██▋       | 4/15 [00:02<00:05,  1.97it/s]
 33%|███▎      | 5/15 [00:03<00:04,  2.44it/s]
 40%|████      | 6/15 [00:03<00:03,  2.84it/s]
 47%|████▋     | 7/15 [00:03<00:02,  3.18it/s]
 53%|█████▎    | 8/15 [00:03<00:02,  3.45it/s]
 60%|██████    | 9/15 [00:04<00:01,  3.66it/s]
 67%|██████▋   | 10/15 [00:04<00:01,  3.81it/s]
 73%|███████▎  | 11/15 [00:04<00:01,  3.92it/s]
 80%|████████  | 12/15 [00:04<00:00,  3.99it/s]
 87%|████████▋ | 13/15 [00:05<00:00,  4.05it/s]
 93%|█████████▎| 14/15 [00:05<00:00,  4.09it/s]
100%|██████████| 15/15 [00:05<00:00,  4.13it/s]
100%|██████████| 15/15 [00:05<00:00,  2.63it/s]

  0%|          | 0/15 [00:00<?, ?it/s]epoch 28 G_lr 1.2e-05 W_lr 2.4e-05
Shuffling data
There are 100 unique labels
reshuffle took 0.028006792068481445 seconds
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  7%|▋         | 1/15 [00:02<00:32,  2.29s/it]
 13%|█▎        | 2/15 [00:02<00:14,  1.09s/it]
 20%|██        | 3/15 [00:02<00:08,  1.41it/s]
 27%|██▋       | 4/15 [00:03<00:05,  1.91it/s]
 33%|███▎      | 5/15 [00:03<00:04,  2.38it/s]
 40%|████      | 6/15 [00:03<00:03,  2.79it/s]
 47%|████▋     | 7/15 [00:03<00:02,  3.14it/s]
 53%|█████▎    | 8/15 [00:03<00:02,  3.42it/s]
 60%|██████    | 9/15 [00:04<00:01,  3.64it/s]
 67%|██████▋   | 10/15 [00:04<00:01,  3.80it/s]
 73%|███████▎  | 11/15 [00:04<00:01,  3.92it/s]
 80%|████████  | 12/15 [00:04<00:00,  4.01it/s]
 87%|████████▋ | 13/15 [00:05<00:00,  4.07it/s]
 93%|█████████▎| 14/15 [00:05<00:00,  4.11it/s]
100%|██████████| 15/15 [00:05<00:00,  4.15it/s]
100%|██████████| 15/15 [00:05<00:00,  2.60it/s]

  0%|          | 0/15 [00:00<?, ?it/s]epoch 29 G_lr 1.2e-05 W_lr 2.4e-05
Shuffling data
There are 100 unique labels
reshuffle took 0.028580427169799805 seconds
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  7%|▋         | 1/15 [00:02<00:28,  2.04s/it]
 13%|█▎        | 2/15 [00:02<00:12,  1.01it/s]
 20%|██        | 3/15 [00:02<00:07,  1.53it/s]
 27%|██▋       | 4/15 [00:02<00:05,  2.04it/s]
 33%|███▎      | 5/15 [00:03<00:03,  2.51it/s]
 40%|████      | 6/15 [00:03<00:03,  2.91it/s]
 47%|████▋     | 7/15 [00:03<00:02,  3.23it/s]
 53%|█████▎    | 8/15 [00:03<00:02,  3.49it/s]
 60%|██████    | 9/15 [00:03<00:01,  3.68it/s]
 67%|██████▋   | 10/15 [00:04<00:01,  3.83it/s]
 73%|███████▎  | 11/15 [00:04<00:01,  3.94it/s]
 80%|████████  | 12/15 [00:04<00:00,  4.02it/s]
 87%|████████▋ | 13/15 [00:04<00:00,  4.07it/s]
 93%|█████████▎| 14/15 [00:05<00:00,  4.10it/s]
100%|██████████| 15/15 [00:05<00:00,  4.12it/s]
100%|██████████| 15/15 [00:05<00:00,  2.71it/s]Testing there are 5924 samples in testset

[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  0%|          | 0/24 [00:00<?, ?it/s]
100%|██████████| 24/24 [00:00<00:00, 269.60it/s]

  0%|          | 0/15 [00:00<?, ?it/s]torch.Size([5924])
Test R @ 1:  0.6818028359216746
epoch 30 G_lr 3.6e-06 W_lr 7.2e-06
Shuffling data
There are 100 unique labels
reshuffle took 0.027016162872314453 seconds
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  7%|▋         | 1/15 [00:02<00:36,  2.58s/it]
 13%|█▎        | 2/15 [00:02<00:15,  1.20s/it]
 20%|██        | 3/15 [00:03<00:09,  1.31it/s]
 27%|██▋       | 4/15 [00:03<00:06,  1.80it/s]
 33%|███▎      | 5/15 [00:03<00:04,  2.27it/s]
 40%|████      | 6/15 [00:03<00:03,  2.69it/s]
 47%|████▋     | 7/15 [00:04<00:02,  3.04it/s]
 53%|█████▎    | 8/15 [00:04<00:02,  3.33it/s]
 60%|██████    | 9/15 [00:04<00:01,  3.55it/s]
 67%|██████▋   | 10/15 [00:04<00:01,  3.71it/s]
 73%|███████▎  | 11/15 [00:04<00:01,  3.84it/s]
 80%|████████  | 12/15 [00:05<00:00,  3.94it/s]
 87%|████████▋ | 13/15 [00:05<00:00,  4.01it/s]
 93%|█████████▎| 14/15 [00:05<00:00,  4.06it/s]
100%|██████████| 15/15 [00:05<00:00,  4.11it/s]
100%|██████████| 15/15 [00:06<00:00,  2.48it/s]

  0%|          | 0/15 [00:00<?, ?it/s]epoch 31 G_lr 3.6e-06 W_lr 7.2e-06
Shuffling data
There are 100 unique labels
reshuffle took 0.02776932716369629 seconds
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  7%|▋         | 1/15 [00:02<00:32,  2.32s/it]
 13%|█▎        | 2/15 [00:02<00:14,  1.10s/it]
 20%|██        | 3/15 [00:02<00:08,  1.41it/s]
 27%|██▋       | 4/15 [00:03<00:05,  1.92it/s]
 33%|███▎      | 5/15 [00:03<00:04,  2.39it/s]
 40%|████      | 6/15 [00:03<00:03,  2.80it/s]
 47%|████▋     | 7/15 [00:03<00:02,  3.15it/s]
 53%|█████▎    | 8/15 [00:03<00:02,  3.42it/s]
 60%|██████    | 9/15 [00:04<00:01,  3.63it/s]
 67%|██████▋   | 10/15 [00:04<00:01,  3.79it/s]
 73%|███████▎  | 11/15 [00:04<00:01,  3.91it/s]
 80%|████████  | 12/15 [00:04<00:00,  4.00it/s]
 87%|████████▋ | 13/15 [00:05<00:00,  4.07it/s]
 93%|█████████▎| 14/15 [00:05<00:00,  4.11it/s]
100%|██████████| 15/15 [00:05<00:00,  4.14it/s]
100%|██████████| 15/15 [00:05<00:00,  2.60it/s]

  0%|          | 0/15 [00:00<?, ?it/s]epoch 32 G_lr 3.6e-06 W_lr 7.2e-06
Shuffling data
There are 100 unique labels
reshuffle took 0.02802586555480957 seconds
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  7%|▋         | 1/15 [00:02<00:29,  2.09s/it]
 13%|█▎        | 2/15 [00:02<00:13,  1.00s/it]
 20%|██        | 3/15 [00:02<00:07,  1.52it/s]
 27%|██▋       | 4/15 [00:02<00:05,  2.03it/s]
 33%|███▎      | 5/15 [00:03<00:04,  2.49it/s]
 40%|████      | 6/15 [00:03<00:03,  2.87it/s]
 47%|████▋     | 7/15 [00:03<00:02,  3.19it/s]
 53%|█████▎    | 8/15 [00:03<00:02,  3.44it/s]
 60%|██████    | 9/15 [00:04<00:01,  3.62it/s]
 67%|██████▋   | 10/15 [00:04<00:01,  3.73it/s]
 73%|███████▎  | 11/15 [00:04<00:01,  3.82it/s]
 80%|████████  | 12/15 [00:04<00:00,  3.88it/s]
 87%|████████▋ | 13/15 [00:05<00:00,  3.95it/s]
 93%|█████████▎| 14/15 [00:05<00:00,  4.01it/s]
100%|██████████| 15/15 [00:05<00:00,  4.02it/s]
100%|██████████| 15/15 [00:05<00:00,  2.64it/s]

  0%|          | 0/15 [00:00<?, ?it/s]epoch 33 G_lr 3.6e-06 W_lr 7.2e-06
Shuffling data
There are 100 unique labels
reshuffle took 0.02922964096069336 seconds
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  7%|▋         | 1/15 [00:02<00:30,  2.21s/it]
 13%|█▎        | 2/15 [00:02<00:16,  1.24s/it]
 20%|██        | 3/15 [00:03<00:09,  1.28it/s]
 27%|██▋       | 4/15 [00:03<00:06,  1.76it/s]
 33%|███▎      | 5/15 [00:03<00:04,  2.23it/s]
 40%|████      | 6/15 [00:03<00:03,  2.65it/s]
 47%|████▋     | 7/15 [00:03<00:02,  3.02it/s]
 53%|█████▎    | 8/15 [00:04<00:02,  3.31it/s]
 60%|██████    | 9/15 [00:04<00:01,  3.54it/s]
 67%|██████▋   | 10/15 [00:04<00:01,  3.72it/s]
 73%|███████▎  | 11/15 [00:04<00:01,  3.85it/s]
 80%|████████  | 12/15 [00:05<00:00,  3.94it/s]
 87%|████████▋ | 13/15 [00:05<00:00,  4.00it/s]
 93%|█████████▎| 14/15 [00:05<00:00,  4.04it/s]
100%|██████████| 15/15 [00:05<00:00,  4.08it/s]
100%|██████████| 15/15 [00:06<00:00,  2.49it/s]

  0%|          | 0/15 [00:00<?, ?it/s]epoch 34 G_lr 3.6e-06 W_lr 7.2e-06
Shuffling data
There are 100 unique labels
reshuffle took 0.029794692993164062 seconds
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  7%|▋         | 1/15 [00:02<00:30,  2.18s/it]
 13%|█▎        | 2/15 [00:02<00:15,  1.16s/it]
 20%|██        | 3/15 [00:02<00:08,  1.35it/s]
 27%|██▋       | 4/15 [00:03<00:05,  1.85it/s]
 33%|███▎      | 5/15 [00:03<00:04,  2.32it/s]
 40%|████      | 6/15 [00:03<00:03,  2.73it/s]
 47%|████▋     | 7/15 [00:03<00:02,  3.09it/s]
 53%|█████▎    | 8/15 [00:04<00:02,  3.37it/s]
 60%|██████    | 9/15 [00:04<00:01,  3.60it/s]
 67%|██████▋   | 10/15 [00:04<00:01,  3.77it/s]
 73%|███████▎  | 11/15 [00:04<00:01,  3.89it/s]
 80%|████████  | 12/15 [00:05<00:00,  3.99it/s]
 87%|████████▋ | 13/15 [00:05<00:00,  4.05it/s]
 93%|█████████▎| 14/15 [00:05<00:00,  4.10it/s]
100%|██████████| 15/15 [00:05<00:00,  4.13it/s]
100%|██████████| 15/15 [00:05<00:00,  2.57it/s]Testing there are 5924 samples in testset

[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  0%|          | 0/24 [00:00<?, ?it/s]
100%|██████████| 24/24 [00:00<00:00, 242.21it/s]

  0%|          | 0/15 [00:00<?, ?it/s]torch.Size([5924])
Test R @ 1:  0.6824780553679946
epoch 35 G_lr 3.6e-06 W_lr 7.2e-06
Shuffling data
There are 100 unique labels
reshuffle took 0.02719426155090332 seconds
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  7%|▋         | 1/15 [00:02<00:37,  2.65s/it]
 13%|█▎        | 2/15 [00:02<00:16,  1.23s/it]
 20%|██        | 3/15 [00:03<00:09,  1.28it/s]
 27%|██▋       | 4/15 [00:03<00:06,  1.77it/s]
 33%|███▎      | 5/15 [00:03<00:04,  2.24it/s]
 40%|████      | 6/15 [00:03<00:03,  2.66it/s]
 47%|████▋     | 7/15 [00:04<00:02,  3.03it/s]
 53%|█████▎    | 8/15 [00:04<00:02,  3.32it/s]
 60%|██████    | 9/15 [00:04<00:01,  3.55it/s]
 67%|██████▋   | 10/15 [00:04<00:01,  3.73it/s]
 73%|███████▎  | 11/15 [00:05<00:01,  3.86it/s]
 80%|████████  | 12/15 [00:05<00:00,  3.96it/s]
 87%|████████▋ | 13/15 [00:05<00:00,  4.03it/s]
 93%|█████████▎| 14/15 [00:05<00:00,  4.09it/s]
100%|██████████| 15/15 [00:05<00:00,  4.12it/s]
100%|██████████| 15/15 [00:06<00:00,  2.46it/s]

  0%|          | 0/15 [00:00<?, ?it/s]epoch 36 G_lr 3.6e-06 W_lr 7.2e-06
Shuffling data
There are 100 unique labels
reshuffle took 0.027943134307861328 seconds
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  7%|▋         | 1/15 [00:02<00:28,  2.02s/it]
 13%|█▎        | 2/15 [00:02<00:12,  1.02it/s]
 20%|██        | 3/15 [00:02<00:09,  1.23it/s]
 27%|██▋       | 4/15 [00:03<00:06,  1.71it/s]
 33%|███▎      | 5/15 [00:03<00:04,  2.16it/s]
 40%|████      | 6/15 [00:03<00:03,  2.57it/s]
 47%|████▋     | 7/15 [00:03<00:02,  2.91it/s]
 53%|█████▎    | 8/15 [00:04<00:02,  3.22it/s]
 60%|██████    | 9/15 [00:04<00:01,  3.48it/s]
 67%|██████▋   | 10/15 [00:04<00:01,  3.67it/s]
 73%|███████▎  | 11/15 [00:04<00:01,  3.83it/s]
 80%|████████  | 12/15 [00:05<00:00,  3.94it/s]
 87%|████████▋ | 13/15 [00:05<00:00,  4.03it/s]
 93%|█████████▎| 14/15 [00:05<00:00,  4.09it/s]
100%|██████████| 15/15 [00:05<00:00,  4.12it/s]
100%|██████████| 15/15 [00:05<00:00,  2.55it/s]

  0%|          | 0/15 [00:00<?, ?it/s]epoch 37 G_lr 3.6e-06 W_lr 7.2e-06
Shuffling data
There are 100 unique labels
reshuffle took 0.0284881591796875 seconds
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  7%|▋         | 1/15 [00:01<00:27,  1.94s/it]
 13%|█▎        | 2/15 [00:02<00:12,  1.07it/s]
 20%|██        | 3/15 [00:02<00:08,  1.43it/s]
 27%|██▋       | 4/15 [00:02<00:05,  1.93it/s]
 33%|███▎      | 5/15 [00:03<00:04,  2.40it/s]
 40%|████      | 6/15 [00:03<00:03,  2.81it/s]
 47%|████▋     | 7/15 [00:03<00:02,  3.16it/s]
 53%|█████▎    | 8/15 [00:03<00:02,  3.43it/s]
 60%|██████    | 9/15 [00:04<00:01,  3.65it/s]
 67%|██████▋   | 10/15 [00:04<00:01,  3.80it/s]
 73%|███████▎  | 11/15 [00:04<00:01,  3.91it/s]
 80%|████████  | 12/15 [00:04<00:00,  4.00it/s]
 87%|████████▋ | 13/15 [00:04<00:00,  4.06it/s]
 93%|█████████▎| 14/15 [00:05<00:00,  4.11it/s]
100%|██████████| 15/15 [00:05<00:00,  4.13it/s]
100%|██████████| 15/15 [00:05<00:00,  2.68it/s]

  0%|          | 0/15 [00:00<?, ?it/s]epoch 38 G_lr 3.6e-06 W_lr 7.2e-06
Shuffling data
There are 100 unique labels
reshuffle took 0.029122114181518555 seconds
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  7%|▋         | 1/15 [00:02<00:29,  2.13s/it]
 13%|█▎        | 2/15 [00:02<00:17,  1.35s/it]
 20%|██        | 3/15 [00:03<00:10,  1.19it/s]
 27%|██▋       | 4/15 [00:03<00:06,  1.66it/s]
 33%|███▎      | 5/15 [00:03<00:04,  2.13it/s]
 40%|████      | 6/15 [00:03<00:03,  2.56it/s]
 47%|████▋     | 7/15 [00:04<00:02,  2.94it/s]
 53%|█████▎    | 8/15 [00:04<00:02,  3.25it/s]
 60%|██████    | 9/15 [00:04<00:01,  3.50it/s]
 67%|██████▋   | 10/15 [00:04<00:01,  3.69it/s]
 73%|███████▎  | 11/15 [00:05<00:01,  3.84it/s]
 80%|████████  | 12/15 [00:05<00:00,  3.95it/s]
 87%|████████▋ | 13/15 [00:05<00:00,  4.03it/s]
 93%|█████████▎| 14/15 [00:05<00:00,  4.08it/s]
100%|██████████| 15/15 [00:06<00:00,  4.12it/s]
100%|██████████| 15/15 [00:06<00:00,  2.44it/s]

  0%|          | 0/15 [00:00<?, ?it/s]epoch 39 G_lr 3.6e-06 W_lr 7.2e-06
Shuffling data
There are 100 unique labels
reshuffle took 0.027560710906982422 seconds
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  7%|▋         | 1/15 [00:01<00:27,  2.00s/it]
 13%|█▎        | 2/15 [00:02<00:12,  1.04it/s]
 20%|██        | 3/15 [00:02<00:07,  1.58it/s]
 27%|██▋       | 4/15 [00:02<00:05,  2.10it/s]
 33%|███▎      | 5/15 [00:02<00:03,  2.56it/s]
 40%|████      | 6/15 [00:03<00:03,  2.95it/s]
 47%|████▋     | 7/15 [00:03<00:02,  3.27it/s]
 53%|█████▎    | 8/15 [00:03<00:01,  3.52it/s]
 60%|██████    | 9/15 [00:03<00:01,  3.70it/s]
 67%|██████▋   | 10/15 [00:04<00:01,  3.84it/s]
 73%|███████▎  | 11/15 [00:04<00:01,  3.94it/s]
 80%|████████  | 12/15 [00:04<00:00,  4.00it/s]
 87%|████████▋ | 13/15 [00:04<00:00,  4.05it/s]
 93%|█████████▎| 14/15 [00:05<00:00,  4.09it/s]
100%|██████████| 15/15 [00:05<00:00,  4.11it/s]
100%|██████████| 15/15 [00:05<00:00,  2.74it/s]Testing there are 5924 samples in testset

[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  0%|          | 0/24 [00:00<?, ?it/s]
100%|██████████| 24/24 [00:00<00:00, 276.28it/s]

  0%|          | 0/15 [00:00<?, ?it/s]torch.Size([5924])
Test R @ 1:  0.6846725185685347
beat test acc, saving model ... 
epoch 40 G_lr 3.6e-06 W_lr 7.2e-06
Shuffling data
There are 100 unique labels
reshuffle took 0.026597261428833008 seconds
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  7%|▋         | 1/15 [00:01<00:26,  1.91s/it]
 13%|█▎        | 2/15 [00:02<00:12,  1.02it/s]
 20%|██        | 3/15 [00:02<00:07,  1.53it/s]
 27%|██▋       | 4/15 [00:02<00:05,  2.04it/s]
 33%|███▎      | 5/15 [00:02<00:03,  2.50it/s]
 40%|████      | 6/15 [00:03<00:03,  2.90it/s]
 47%|████▋     | 7/15 [00:03<00:02,  3.22it/s]
 53%|█████▎    | 8/15 [00:03<00:02,  3.47it/s]
 60%|██████    | 9/15 [00:03<00:01,  3.67it/s]
 67%|██████▋   | 10/15 [00:04<00:01,  3.81it/s]
 73%|███████▎  | 11/15 [00:04<00:01,  3.93it/s]
 80%|████████  | 12/15 [00:04<00:00,  4.00it/s]
 87%|████████▋ | 13/15 [00:04<00:00,  4.05it/s]
 93%|█████████▎| 14/15 [00:05<00:00,  4.09it/s]
100%|██████████| 15/15 [00:05<00:00,  4.12it/s]
100%|██████████| 15/15 [00:05<00:00,  2.71it/s]

  0%|          | 0/15 [00:00<?, ?it/s]epoch 41 G_lr 3.6e-06 W_lr 7.2e-06
Shuffling data
There are 100 unique labels
reshuffle took 0.028409481048583984 seconds
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  7%|▋         | 1/15 [00:02<00:37,  2.65s/it]
 13%|█▎        | 2/15 [00:02<00:15,  1.23s/it]
 20%|██        | 3/15 [00:03<00:09,  1.29it/s]
 27%|██▋       | 4/15 [00:03<00:06,  1.77it/s]
 33%|███▎      | 5/15 [00:03<00:04,  2.23it/s]
 40%|████      | 6/15 [00:03<00:03,  2.66it/s]
 47%|████▋     | 7/15 [00:04<00:02,  3.02it/s]
 53%|█████▎    | 8/15 [00:04<00:02,  3.32it/s]
 60%|██████    | 9/15 [00:04<00:01,  3.56it/s]
 67%|██████▋   | 10/15 [00:04<00:01,  3.73it/s]
 73%|███████▎  | 11/15 [00:05<00:01,  3.87it/s]
 80%|████████  | 12/15 [00:05<00:00,  3.97it/s]
 87%|████████▋ | 13/15 [00:05<00:00,  4.03it/s]
 93%|█████████▎| 14/15 [00:05<00:00,  4.06it/s]
100%|██████████| 15/15 [00:05<00:00,  4.09it/s]
100%|██████████| 15/15 [00:06<00:00,  2.44it/s]

  0%|          | 0/15 [00:00<?, ?it/s]epoch 42 G_lr 3.6e-06 W_lr 7.2e-06
Shuffling data
There are 100 unique labels
reshuffle took 0.02935481071472168 seconds
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  7%|▋         | 1/15 [00:02<00:39,  2.83s/it]
 13%|█▎        | 2/15 [00:03<00:17,  1.31s/it]
 20%|██        | 3/15 [00:03<00:09,  1.22it/s]
 27%|██▋       | 4/15 [00:03<00:06,  1.69it/s]
 33%|███▎      | 5/15 [00:03<00:04,  2.16it/s]
 40%|████      | 6/15 [00:04<00:03,  2.59it/s]
 47%|████▋     | 7/15 [00:04<00:02,  2.96it/s]
 53%|█████▎    | 8/15 [00:04<00:02,  3.27it/s]
 60%|██████    | 9/15 [00:04<00:01,  3.52it/s]
 67%|██████▋   | 10/15 [00:04<00:01,  3.71it/s]
 73%|███████▎  | 11/15 [00:05<00:01,  3.86it/s]
 80%|████████  | 12/15 [00:05<00:00,  3.96it/s]
 87%|████████▋ | 13/15 [00:05<00:00,  4.02it/s]
 93%|█████████▎| 14/15 [00:05<00:00,  4.08it/s]
100%|██████████| 15/15 [00:06<00:00,  4.12it/s]
100%|██████████| 15/15 [00:06<00:00,  2.39it/s]

  0%|          | 0/15 [00:00<?, ?it/s]epoch 43 G_lr 3.6e-06 W_lr 7.2e-06
Shuffling data
There are 100 unique labels
reshuffle took 0.02792525291442871 seconds
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  7%|▋         | 1/15 [00:02<00:28,  2.00s/it]
 13%|█▎        | 2/15 [00:02<00:15,  1.22s/it]
 20%|██        | 3/15 [00:02<00:09,  1.29it/s]
 27%|██▋       | 4/15 [00:03<00:06,  1.78it/s]
 33%|███▎      | 5/15 [00:03<00:04,  2.25it/s]
 40%|████      | 6/15 [00:03<00:03,  2.67it/s]
 47%|████▋     | 7/15 [00:03<00:02,  3.03it/s]
 53%|█████▎    | 8/15 [00:04<00:02,  3.32it/s]
 60%|██████    | 9/15 [00:04<00:01,  3.56it/s]
 67%|██████▋   | 10/15 [00:04<00:01,  3.73it/s]
 73%|███████▎  | 11/15 [00:04<00:01,  3.85it/s]
 80%|████████  | 12/15 [00:05<00:00,  3.94it/s]
 87%|████████▋ | 13/15 [00:05<00:00,  4.01it/s]
 93%|█████████▎| 14/15 [00:05<00:00,  4.05it/s]
100%|██████████| 15/15 [00:05<00:00,  4.09it/s]
100%|██████████| 15/15 [00:05<00:00,  2.53it/s]

  0%|          | 0/15 [00:00<?, ?it/s]epoch 44 G_lr 3.6e-06 W_lr 7.2e-06
Shuffling data
There are 100 unique labels
reshuffle took 0.028473615646362305 seconds
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  7%|▋         | 1/15 [00:02<00:28,  2.02s/it]
 13%|█▎        | 2/15 [00:02<00:12,  1.02it/s]
 20%|██        | 3/15 [00:02<00:07,  1.55it/s]
 27%|██▋       | 4/15 [00:02<00:05,  2.07it/s]
 33%|███▎      | 5/15 [00:02<00:03,  2.54it/s]
 40%|████      | 6/15 [00:03<00:03,  2.88it/s]
 47%|████▋     | 7/15 [00:03<00:02,  3.21it/s]
 53%|█████▎    | 8/15 [00:03<00:02,  3.47it/s]
 60%|██████    | 9/15 [00:03<00:01,  3.67it/s]
 67%|██████▋   | 10/15 [00:04<00:01,  3.83it/s]
 73%|███████▎  | 11/15 [00:04<00:01,  3.94it/s]
 80%|████████  | 12/15 [00:04<00:00,  4.02it/s]
 87%|████████▋ | 13/15 [00:04<00:00,  4.08it/s]
 93%|█████████▎| 14/15 [00:05<00:00,  4.12it/s]
100%|██████████| 15/15 [00:05<00:00,  4.14it/s]
100%|██████████| 15/15 [00:05<00:00,  2.72it/s]Testing there are 5924 samples in testset

[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  0%|          | 0/24 [00:00<?, ?it/s]
100%|██████████| 24/24 [00:00<00:00, 270.08it/s]

  0%|          | 0/15 [00:00<?, ?it/s]torch.Size([5924])
Test R @ 1:  0.6863605671843349
beat test acc, saving model ... 
epoch 45 G_lr 1.0799999999999998e-06 W_lr 2.1599999999999996e-06
Shuffling data
There are 100 unique labels
reshuffle took 0.02683711051940918 seconds
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  7%|▋         | 1/15 [00:02<00:35,  2.56s/it]
 13%|█▎        | 2/15 [00:02<00:15,  1.19s/it]
 20%|██        | 3/15 [00:03<00:09,  1.32it/s]
 27%|██▋       | 4/15 [00:03<00:06,  1.81it/s]
 33%|███▎      | 5/15 [00:03<00:04,  2.28it/s]
 40%|████      | 6/15 [00:03<00:03,  2.70it/s]
 47%|████▋     | 7/15 [00:03<00:02,  3.05it/s]
 53%|█████▎    | 8/15 [00:04<00:02,  3.33it/s]
 60%|██████    | 9/15 [00:04<00:01,  3.47it/s]
 67%|██████▋   | 10/15 [00:04<00:01,  3.59it/s]
 73%|███████▎  | 11/15 [00:05<00:01,  3.60it/s]
 80%|████████  | 12/15 [00:05<00:00,  3.66it/s]
 87%|████████▋ | 13/15 [00:05<00:00,  3.80it/s]
 93%|█████████▎| 14/15 [00:05<00:00,  3.90it/s]
100%|██████████| 15/15 [00:06<00:00,  3.97it/s]
100%|██████████| 15/15 [00:06<00:00,  2.43it/s]

  0%|          | 0/15 [00:00<?, ?it/s]epoch 46 G_lr 1.0799999999999998e-06 W_lr 2.1599999999999996e-06
Shuffling data
There are 100 unique labels
reshuffle took 0.029704570770263672 seconds
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  7%|▋         | 1/15 [00:02<00:36,  2.58s/it]
 13%|█▎        | 2/15 [00:02<00:15,  1.20s/it]
 20%|██        | 3/15 [00:03<00:09,  1.32it/s]
 27%|██▋       | 4/15 [00:03<00:06,  1.81it/s]
 33%|███▎      | 5/15 [00:03<00:04,  2.28it/s]
 40%|████      | 6/15 [00:03<00:03,  2.70it/s]
 47%|████▋     | 7/15 [00:04<00:02,  3.04it/s]
 53%|█████▎    | 8/15 [00:04<00:02,  3.33it/s]
 60%|██████    | 9/15 [00:04<00:01,  3.57it/s]
 67%|██████▋   | 10/15 [00:04<00:01,  3.75it/s]
 73%|███████▎  | 11/15 [00:04<00:01,  3.88it/s]
 80%|████████  | 12/15 [00:05<00:00,  3.97it/s]
 87%|████████▋ | 13/15 [00:05<00:00,  4.04it/s]
 93%|█████████▎| 14/15 [00:05<00:00,  4.09it/s]
100%|██████████| 15/15 [00:05<00:00,  4.09it/s]
100%|██████████| 15/15 [00:06<00:00,  2.49it/s]

  0%|          | 0/15 [00:00<?, ?it/s]epoch 47 G_lr 1.0799999999999998e-06 W_lr 2.1599999999999996e-06
Shuffling data
There are 100 unique labels
reshuffle took 0.029990673065185547 seconds
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  7%|▋         | 1/15 [00:02<00:34,  2.47s/it]
 13%|█▎        | 2/15 [00:02<00:15,  1.16s/it]
 20%|██        | 3/15 [00:02<00:08,  1.35it/s]
 27%|██▋       | 4/15 [00:03<00:05,  1.84it/s]
 33%|███▎      | 5/15 [00:03<00:04,  2.31it/s]
 40%|████      | 6/15 [00:03<00:03,  2.73it/s]
 47%|████▋     | 7/15 [00:03<00:02,  3.08it/s]
 53%|█████▎    | 8/15 [00:04<00:02,  3.37it/s]
 60%|██████    | 9/15 [00:04<00:01,  3.59it/s]
 67%|██████▋   | 10/15 [00:04<00:01,  3.76it/s]
 73%|███████▎  | 11/15 [00:04<00:01,  3.89it/s]
 80%|████████  | 12/15 [00:05<00:00,  3.99it/s]
 87%|████████▋ | 13/15 [00:05<00:00,  4.05it/s]
 93%|█████████▎| 14/15 [00:05<00:00,  4.09it/s]
100%|██████████| 15/15 [00:05<00:00,  4.12it/s]
100%|██████████| 15/15 [00:05<00:00,  2.52it/s]

  0%|          | 0/15 [00:00<?, ?it/s]epoch 48 G_lr 1.0799999999999998e-06 W_lr 2.1599999999999996e-06
Shuffling data
There are 100 unique labels
reshuffle took 0.02951359748840332 seconds
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  7%|▋         | 1/15 [00:02<00:39,  2.79s/it]
 13%|█▎        | 2/15 [00:03<00:16,  1.29s/it]
 20%|██        | 3/15 [00:03<00:09,  1.23it/s]
 27%|██▋       | 4/15 [00:03<00:06,  1.71it/s]
 33%|███▎      | 5/15 [00:03<00:04,  2.17it/s]
 40%|████      | 6/15 [00:03<00:03,  2.60it/s]
 47%|████▋     | 7/15 [00:04<00:02,  2.98it/s]
 53%|█████▎    | 8/15 [00:04<00:02,  3.28it/s]
 60%|██████    | 9/15 [00:04<00:01,  3.53it/s]
 67%|██████▋   | 10/15 [00:04<00:01,  3.71it/s]
 73%|███████▎  | 11/15 [00:05<00:01,  3.85it/s]
 80%|████████  | 12/15 [00:05<00:00,  3.93it/s]
 87%|████████▋ | 13/15 [00:05<00:00,  4.01it/s]
 93%|█████████▎| 14/15 [00:05<00:00,  4.06it/s]
100%|██████████| 15/15 [00:06<00:00,  4.10it/s]
100%|██████████| 15/15 [00:06<00:00,  2.38it/s]

  0%|          | 0/15 [00:00<?, ?it/s]epoch 49 G_lr 1.0799999999999998e-06 W_lr 2.1599999999999996e-06
Shuffling data
There are 100 unique labels
reshuffle took 0.02890467643737793 seconds
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  7%|▋         | 1/15 [00:02<00:38,  2.72s/it]
 13%|█▎        | 2/15 [00:02<00:16,  1.27s/it]
 20%|██        | 3/15 [00:03<00:09,  1.25it/s]
 27%|██▋       | 4/15 [00:03<00:06,  1.73it/s]
 33%|███▎      | 5/15 [00:03<00:04,  2.19it/s]
 40%|████      | 6/15 [00:03<00:03,  2.60it/s]
 47%|████▋     | 7/15 [00:04<00:02,  2.96it/s]
 53%|█████▎    | 8/15 [00:04<00:02,  3.26it/s]
 60%|██████    | 9/15 [00:04<00:01,  3.50it/s]
 67%|██████▋   | 10/15 [00:04<00:01,  3.68it/s]
 73%|███████▎  | 11/15 [00:05<00:01,  3.81it/s]
 80%|████████  | 12/15 [00:05<00:00,  3.92it/s]
 87%|████████▋ | 13/15 [00:05<00:00,  4.00it/s]
 93%|█████████▎| 14/15 [00:05<00:00,  4.06it/s]
100%|██████████| 15/15 [00:06<00:00,  4.10it/s]
100%|██████████| 15/15 [00:06<00:00,  2.41it/s]Testing there are 5924 samples in testset

[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  0%|          | 0/24 [00:00<?, ?it/s]
100%|██████████| 24/24 [00:00<00:00, 268.19it/s]

  0%|          | 0/15 [00:00<?, ?it/s]torch.Size([5924])
Test R @ 1:  0.6861917623227549
epoch 50 G_lr 1.0799999999999998e-06 W_lr 2.1599999999999996e-06
Shuffling data
There are 100 unique labels
reshuffle took 0.02708578109741211 seconds
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  7%|▋         | 1/15 [00:02<00:31,  2.24s/it]
 13%|█▎        | 2/15 [00:02<00:13,  1.06s/it]
 20%|██        | 3/15 [00:02<00:08,  1.46it/s]
 27%|██▋       | 4/15 [00:02<00:05,  1.97it/s]
 33%|███▎      | 5/15 [00:03<00:04,  2.42it/s]
 40%|████      | 6/15 [00:03<00:03,  2.83it/s]
 47%|████▋     | 7/15 [00:03<00:02,  3.17it/s]
 53%|█████▎    | 8/15 [00:03<00:02,  3.44it/s]
 60%|██████    | 9/15 [00:04<00:01,  3.65it/s]
 67%|██████▋   | 10/15 [00:04<00:01,  3.81it/s]
 73%|███████▎  | 11/15 [00:04<00:01,  3.93it/s]
 80%|████████  | 12/15 [00:04<00:00,  4.01it/s]
 87%|████████▋ | 13/15 [00:05<00:00,  4.07it/s]
 93%|█████████▎| 14/15 [00:05<00:00,  4.11it/s]
100%|██████████| 15/15 [00:05<00:00,  4.13it/s]
100%|██████████| 15/15 [00:05<00:00,  2.62it/s]

  0%|          | 0/15 [00:00<?, ?it/s]epoch 51 G_lr 1.0799999999999998e-06 W_lr 2.1599999999999996e-06
Shuffling data
There are 100 unique labels
reshuffle took 0.028468608856201172 seconds
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  7%|▋         | 1/15 [00:02<00:34,  2.45s/it]
 13%|█▎        | 2/15 [00:02<00:14,  1.15s/it]
 20%|██        | 3/15 [00:02<00:08,  1.36it/s]
 27%|██▋       | 4/15 [00:03<00:05,  1.86it/s]
 33%|███▎      | 5/15 [00:03<00:04,  2.33it/s]
 40%|████      | 6/15 [00:03<00:03,  2.75it/s]
 47%|████▋     | 7/15 [00:03<00:02,  3.10it/s]
 53%|█████▎    | 8/15 [00:04<00:02,  3.39it/s]
 60%|██████    | 9/15 [00:04<00:01,  3.61it/s]
 67%|██████▋   | 10/15 [00:04<00:01,  3.78it/s]
 73%|███████▎  | 11/15 [00:04<00:01,  3.91it/s]
 80%|████████  | 12/15 [00:05<00:00,  4.00it/s]
 87%|████████▋ | 13/15 [00:05<00:00,  4.06it/s]
 93%|█████████▎| 14/15 [00:05<00:00,  4.11it/s]
100%|██████████| 15/15 [00:05<00:00,  4.14it/s]
100%|██████████| 15/15 [00:05<00:00,  2.53it/s]

  0%|          | 0/15 [00:00<?, ?it/s]epoch 52 G_lr 1.0799999999999998e-06 W_lr 2.1599999999999996e-06
Shuffling data
There are 100 unique labels
reshuffle took 0.028659820556640625 seconds
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  7%|▋         | 1/15 [00:02<00:28,  2.03s/it]
 13%|█▎        | 2/15 [00:02<00:12,  1.02it/s]
 20%|██        | 3/15 [00:02<00:07,  1.53it/s]
 27%|██▋       | 4/15 [00:02<00:05,  2.05it/s]
 33%|███▎      | 5/15 [00:03<00:03,  2.51it/s]
 40%|████      | 6/15 [00:03<00:03,  2.92it/s]
 47%|████▋     | 7/15 [00:03<00:02,  3.24it/s]
 53%|█████▎    | 8/15 [00:03<00:02,  3.50it/s]
 60%|██████    | 9/15 [00:03<00:01,  3.70it/s]
 67%|██████▋   | 10/15 [00:04<00:01,  3.83it/s]
 73%|███████▎  | 11/15 [00:04<00:01,  3.94it/s]
 80%|████████  | 12/15 [00:04<00:00,  4.02it/s]
 87%|████████▋ | 13/15 [00:04<00:00,  4.08it/s]
 93%|█████████▎| 14/15 [00:05<00:00,  4.12it/s]
100%|██████████| 15/15 [00:05<00:00,  4.14it/s]
100%|██████████| 15/15 [00:05<00:00,  2.71it/s]

  0%|          | 0/15 [00:00<?, ?it/s]epoch 53 G_lr 1.0799999999999998e-06 W_lr 2.1599999999999996e-06
Shuffling data
There are 100 unique labels
reshuffle took 0.02921462059020996 seconds
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  7%|▋         | 1/15 [00:02<00:28,  2.03s/it]
 13%|█▎        | 2/15 [00:02<00:15,  1.21s/it]
 20%|██        | 3/15 [00:02<00:09,  1.31it/s]
 27%|██▋       | 4/15 [00:03<00:06,  1.80it/s]
 33%|███▎      | 5/15 [00:03<00:04,  2.27it/s]
 40%|████      | 6/15 [00:03<00:03,  2.69it/s]
 47%|████▋     | 7/15 [00:03<00:02,  3.05it/s]
 53%|█████▎    | 8/15 [00:04<00:02,  3.35it/s]
 60%|██████    | 9/15 [00:04<00:01,  3.58it/s]
 67%|██████▋   | 10/15 [00:04<00:01,  3.76it/s]
 73%|███████▎  | 11/15 [00:04<00:01,  3.89it/s]
 80%|████████  | 12/15 [00:05<00:00,  3.98it/s]
 87%|████████▋ | 13/15 [00:05<00:00,  4.05it/s]
 93%|█████████▎| 14/15 [00:05<00:00,  4.10it/s]
100%|██████████| 15/15 [00:05<00:00,  4.14it/s]
100%|██████████| 15/15 [00:05<00:00,  2.56it/s]

  0%|          | 0/15 [00:00<?, ?it/s]epoch 54 G_lr 1.0799999999999998e-06 W_lr 2.1599999999999996e-06
Shuffling data
There are 100 unique labels
reshuffle took 0.027826309204101562 seconds
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  7%|▋         | 1/15 [00:02<00:29,  2.13s/it]
 13%|█▎        | 2/15 [00:02<00:13,  1.03s/it]
 20%|██        | 3/15 [00:02<00:07,  1.50it/s]
 27%|██▋       | 4/15 [00:02<00:05,  2.01it/s]
 33%|███▎      | 5/15 [00:03<00:04,  2.48it/s]
 40%|████      | 6/15 [00:03<00:03,  2.88it/s]
 47%|████▋     | 7/15 [00:03<00:02,  3.22it/s]
 53%|█████▎    | 8/15 [00:03<00:02,  3.47it/s]
 60%|██████    | 9/15 [00:04<00:01,  3.66it/s]
 67%|██████▋   | 10/15 [00:04<00:01,  3.81it/s]
 73%|███████▎  | 11/15 [00:04<00:01,  3.92it/s]
 80%|████████  | 12/15 [00:04<00:00,  3.99it/s]
 87%|████████▋ | 13/15 [00:05<00:00,  4.05it/s]
 93%|█████████▎| 14/15 [00:05<00:00,  4.09it/s]
100%|██████████| 15/15 [00:05<00:00,  4.12it/s]
100%|██████████| 15/15 [00:05<00:00,  2.66it/s]Testing there are 5924 samples in testset

[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  0%|          | 0/24 [00:00<?, ?it/s]
100%|██████████| 24/24 [00:00<00:00, 268.71it/s]

  0%|          | 0/15 [00:00<?, ?it/s]torch.Size([5924])
Test R @ 1:  0.6855165428764348
epoch 55 G_lr 1.0799999999999998e-06 W_lr 2.1599999999999996e-06
Shuffling data
There are 100 unique labels
reshuffle took 0.02651238441467285 seconds
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  7%|▋         | 1/15 [00:02<00:30,  2.14s/it]
 13%|█▎        | 2/15 [00:02<00:13,  1.03s/it]
 20%|██        | 3/15 [00:02<00:08,  1.49it/s]
 27%|██▋       | 4/15 [00:02<00:05,  2.00it/s]
 33%|███▎      | 5/15 [00:03<00:04,  2.44it/s]
 40%|████      | 6/15 [00:03<00:03,  2.85it/s]
 47%|████▋     | 7/15 [00:03<00:02,  3.18it/s]
 53%|█████▎    | 8/15 [00:03<00:02,  3.44it/s]
 60%|██████    | 9/15 [00:04<00:01,  3.64it/s]
 67%|██████▋   | 10/15 [00:04<00:01,  3.79it/s]
 73%|███████▎  | 11/15 [00:04<00:01,  3.91it/s]
 80%|████████  | 12/15 [00:04<00:00,  3.99it/s]
 87%|████████▋ | 13/15 [00:05<00:00,  4.06it/s]
 93%|█████████▎| 14/15 [00:05<00:00,  4.10it/s]
100%|██████████| 15/15 [00:05<00:00,  4.14it/s]
100%|██████████| 15/15 [00:05<00:00,  2.65it/s]

  0%|          | 0/15 [00:00<?, ?it/s]epoch 56 G_lr 1.0799999999999998e-06 W_lr 2.1599999999999996e-06
Shuffling data
There are 100 unique labels
reshuffle took 0.028038978576660156 seconds
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  7%|▋         | 1/15 [00:02<00:29,  2.12s/it]
 13%|█▎        | 2/15 [00:02<00:16,  1.25s/it]
 20%|██        | 3/15 [00:02<00:09,  1.27it/s]
 27%|██▋       | 4/15 [00:03<00:06,  1.76it/s]
 33%|███▎      | 5/15 [00:03<00:04,  2.23it/s]
 40%|████      | 6/15 [00:03<00:03,  2.65it/s]
 47%|████▋     | 7/15 [00:03<00:02,  3.02it/s]
 53%|█████▎    | 8/15 [00:04<00:02,  3.32it/s]
 60%|██████    | 9/15 [00:04<00:01,  3.56it/s]
 67%|██████▋   | 10/15 [00:04<00:01,  3.74it/s]
 73%|███████▎  | 11/15 [00:04<00:01,  3.88it/s]
 80%|████████  | 12/15 [00:05<00:00,  3.98it/s]
 87%|████████▋ | 13/15 [00:05<00:00,  4.03it/s]
 93%|█████████▎| 14/15 [00:05<00:00,  4.08it/s]
100%|██████████| 15/15 [00:05<00:00,  4.12it/s]
100%|██████████| 15/15 [00:05<00:00,  2.52it/s]

  0%|          | 0/15 [00:00<?, ?it/s]epoch 57 G_lr 1.0799999999999998e-06 W_lr 2.1599999999999996e-06
Shuffling data
There are 100 unique labels
reshuffle took 0.027936935424804688 seconds
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  7%|▋         | 1/15 [00:02<00:33,  2.39s/it]
 13%|█▎        | 2/15 [00:02<00:16,  1.24s/it]
 20%|██        | 3/15 [00:03<00:09,  1.28it/s]
 27%|██▋       | 4/15 [00:03<00:06,  1.76it/s]
 33%|███▎      | 5/15 [00:03<00:04,  2.23it/s]
 40%|████      | 6/15 [00:03<00:03,  2.65it/s]
 47%|████▋     | 7/15 [00:04<00:02,  3.01it/s]
 53%|█████▎    | 8/15 [00:04<00:02,  3.30it/s]
 60%|██████    | 9/15 [00:04<00:01,  3.53it/s]
 67%|██████▋   | 10/15 [00:04<00:01,  3.71it/s]
 73%|███████▎  | 11/15 [00:04<00:01,  3.84it/s]
 80%|████████  | 12/15 [00:05<00:00,  3.94it/s]
 87%|████████▋ | 13/15 [00:05<00:00,  4.01it/s]
 93%|█████████▎| 14/15 [00:05<00:00,  4.06it/s]
100%|██████████| 15/15 [00:05<00:00,  4.10it/s]
100%|██████████| 15/15 [00:06<00:00,  2.47it/s]

  0%|          | 0/15 [00:00<?, ?it/s]epoch 58 G_lr 1.0799999999999998e-06 W_lr 2.1599999999999996e-06
Shuffling data
There are 100 unique labels
reshuffle took 0.02977275848388672 seconds
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  7%|▋         | 1/15 [00:02<00:36,  2.59s/it]
 13%|█▎        | 2/15 [00:02<00:15,  1.21s/it]
 20%|██        | 3/15 [00:03<00:09,  1.31it/s]
 27%|██▋       | 4/15 [00:03<00:06,  1.80it/s]
 33%|███▎      | 5/15 [00:03<00:04,  2.27it/s]
 40%|████      | 6/15 [00:03<00:03,  2.69it/s]
 47%|████▋     | 7/15 [00:04<00:02,  3.04it/s]
 53%|█████▎    | 8/15 [00:04<00:02,  3.33it/s]
 60%|██████    | 9/15 [00:04<00:01,  3.56it/s]
 67%|██████▋   | 10/15 [00:04<00:01,  3.73it/s]
 73%|███████▎  | 11/15 [00:04<00:01,  3.85it/s]
 80%|████████  | 12/15 [00:05<00:00,  3.95it/s]
 87%|████████▋ | 13/15 [00:05<00:00,  4.01it/s]
 93%|█████████▎| 14/15 [00:05<00:00,  4.06it/s]
100%|██████████| 15/15 [00:05<00:00,  4.10it/s]
100%|██████████| 15/15 [00:06<00:00,  2.47it/s]

  0%|          | 0/15 [00:00<?, ?it/s]epoch 59 G_lr 1.0799999999999998e-06 W_lr 2.1599999999999996e-06
Shuffling data
There are 100 unique labels
reshuffle took 0.02823472023010254 seconds
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  7%|▋         | 1/15 [00:01<00:26,  1.90s/it]
 13%|█▎        | 2/15 [00:02<00:12,  1.08it/s]
 20%|██        | 3/15 [00:02<00:07,  1.62it/s]
 27%|██▋       | 4/15 [00:02<00:05,  2.13it/s]
 33%|███▎      | 5/15 [00:02<00:03,  2.59it/s]
 40%|████      | 6/15 [00:03<00:03,  2.98it/s]
 47%|████▋     | 7/15 [00:03<00:02,  3.30it/s]
 53%|█████▎    | 8/15 [00:03<00:01,  3.55it/s]
 60%|██████    | 9/15 [00:03<00:01,  3.73it/s]
 67%|██████▋   | 10/15 [00:04<00:01,  3.87it/s]
 73%|███████▎  | 11/15 [00:04<00:01,  3.97it/s]
 80%|████████  | 12/15 [00:04<00:00,  4.05it/s]
 87%|████████▋ | 13/15 [00:04<00:00,  4.10it/s]
 93%|█████████▎| 14/15 [00:05<00:00,  4.14it/s]
100%|██████████| 15/15 [00:05<00:00,  4.17it/s]
100%|██████████| 15/15 [00:05<00:00,  2.80it/s]Testing there are 5924 samples in testset

[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  0%|          | 0/24 [00:00<?, ?it/s]
100%|██████████| 24/24 [00:00<00:00, 265.74it/s]

  0%|          | 0/15 [00:00<?, ?it/s]torch.Size([5924])
Test R @ 1:  0.687879810938555
beat test acc, saving model ... 
epoch 60 G_lr 1.0799999999999998e-06 W_lr 2.1599999999999996e-06
Shuffling data
There are 100 unique labels
reshuffle took 0.027046918869018555 seconds
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  7%|▋         | 1/15 [00:02<00:34,  2.50s/it]
 13%|█▎        | 2/15 [00:02<00:15,  1.17s/it]
 20%|██        | 3/15 [00:02<00:08,  1.35it/s]
 27%|██▋       | 4/15 [00:03<00:05,  1.84it/s]
 33%|███▎      | 5/15 [00:03<00:04,  2.31it/s]
 40%|████      | 6/15 [00:03<00:03,  2.73it/s]
 47%|████▋     | 7/15 [00:03<00:02,  3.09it/s]
 53%|█████▎    | 8/15 [00:04<00:02,  3.38it/s]
 60%|██████    | 9/15 [00:04<00:01,  3.60it/s]
 67%|██████▋   | 10/15 [00:04<00:01,  3.77it/s]
 73%|███████▎  | 11/15 [00:04<00:01,  3.90it/s]
 80%|████████  | 12/15 [00:05<00:00,  4.00it/s]
 87%|████████▋ | 13/15 [00:05<00:00,  4.06it/s]
 93%|█████████▎| 14/15 [00:05<00:00,  4.11it/s]
100%|██████████| 15/15 [00:05<00:00,  4.14it/s]
100%|██████████| 15/15 [00:05<00:00,  2.52it/s]

  0%|          | 0/15 [00:00<?, ?it/s]epoch 61 G_lr 1.0799999999999998e-06 W_lr 2.1599999999999996e-06
Shuffling data
There are 100 unique labels
reshuffle took 0.02833414077758789 seconds
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  7%|▋         | 1/15 [00:02<00:38,  2.75s/it]
 13%|█▎        | 2/15 [00:02<00:16,  1.27s/it]
 20%|██        | 3/15 [00:03<00:09,  1.25it/s]
 27%|██▋       | 4/15 [00:03<00:06,  1.73it/s]
 33%|███▎      | 5/15 [00:03<00:04,  2.20it/s]
 40%|████      | 6/15 [00:03<00:03,  2.63it/s]
 47%|████▋     | 7/15 [00:04<00:02,  3.00it/s]
 53%|█████▎    | 8/15 [00:04<00:02,  3.30it/s]
 60%|██████    | 9/15 [00:04<00:01,  3.55it/s]
 67%|██████▋   | 10/15 [00:04<00:01,  3.73it/s]
 73%|███████▎  | 11/15 [00:05<00:01,  3.87it/s]
 80%|████████  | 12/15 [00:05<00:00,  3.97it/s]
 87%|████████▋ | 13/15 [00:05<00:00,  4.05it/s]
 93%|█████████▎| 14/15 [00:05<00:00,  4.10it/s]
100%|██████████| 15/15 [00:06<00:00,  4.14it/s]
100%|██████████| 15/15 [00:06<00:00,  2.43it/s]

  0%|          | 0/15 [00:00<?, ?it/s]epoch 62 G_lr 1.0799999999999998e-06 W_lr 2.1599999999999996e-06
Shuffling data
There are 100 unique labels
reshuffle took 0.028136730194091797 seconds
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  7%|▋         | 1/15 [00:02<00:32,  2.30s/it]
 13%|█▎        | 2/15 [00:02<00:14,  1.09s/it]
 20%|██        | 3/15 [00:02<00:08,  1.43it/s]
 27%|██▋       | 4/15 [00:03<00:05,  1.94it/s]
 33%|███▎      | 5/15 [00:03<00:04,  2.40it/s]
 40%|████      | 6/15 [00:03<00:03,  2.81it/s]
 47%|████▋     | 7/15 [00:03<00:02,  3.16it/s]
 53%|█████▎    | 8/15 [00:03<00:02,  3.43it/s]
 60%|██████    | 9/15 [00:04<00:01,  3.64it/s]
 67%|██████▋   | 10/15 [00:04<00:01,  3.80it/s]
 73%|███████▎  | 11/15 [00:04<00:01,  3.91it/s]
 80%|████████  | 12/15 [00:04<00:00,  3.99it/s]
 87%|████████▋ | 13/15 [00:05<00:00,  4.05it/s]
 93%|█████████▎| 14/15 [00:05<00:00,  4.09it/s]
100%|██████████| 15/15 [00:05<00:00,  4.12it/s]
100%|██████████| 15/15 [00:05<00:00,  2.59it/s]

  0%|          | 0/15 [00:00<?, ?it/s]epoch 63 G_lr 1.0799999999999998e-06 W_lr 2.1599999999999996e-06
Shuffling data
There are 100 unique labels
reshuffle took 0.028247594833374023 seconds
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  7%|▋         | 1/15 [00:01<00:27,  1.97s/it]
 13%|█▎        | 2/15 [00:02<00:14,  1.13s/it]
 20%|██        | 3/15 [00:02<00:08,  1.39it/s]
 27%|██▋       | 4/15 [00:02<00:05,  1.89it/s]
 33%|███▎      | 5/15 [00:03<00:04,  2.36it/s]
 40%|████      | 6/15 [00:03<00:03,  2.77it/s]
 47%|████▋     | 7/15 [00:03<00:02,  3.11it/s]
 53%|█████▎    | 8/15 [00:03<00:02,  3.39it/s]
 60%|██████    | 9/15 [00:04<00:01,  3.60it/s]
 67%|██████▋   | 10/15 [00:04<00:01,  3.76it/s]
 73%|███████▎  | 11/15 [00:04<00:01,  3.89it/s]
 80%|████████  | 12/15 [00:04<00:00,  3.97it/s]
 87%|████████▋ | 13/15 [00:05<00:00,  4.03it/s]
 93%|█████████▎| 14/15 [00:05<00:00,  4.08it/s]
100%|██████████| 15/15 [00:05<00:00,  4.11it/s]
100%|██████████| 15/15 [00:05<00:00,  2.62it/s]

  0%|          | 0/15 [00:00<?, ?it/s]epoch 64 G_lr 1.0799999999999998e-06 W_lr 2.1599999999999996e-06
Shuffling data
There are 100 unique labels
reshuffle took 0.028403043746948242 seconds
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  7%|▋         | 1/15 [00:02<00:29,  2.08s/it]
 13%|█▎        | 2/15 [00:02<00:13,  1.02s/it]
 20%|██        | 3/15 [00:02<00:08,  1.34it/s]
 27%|██▋       | 4/15 [00:03<00:06,  1.83it/s]
 33%|███▎      | 5/15 [00:03<00:04,  2.29it/s]
 40%|████      | 6/15 [00:03<00:03,  2.71it/s]
 47%|████▋     | 7/15 [00:03<00:02,  3.06it/s]
 53%|█████▎    | 8/15 [00:03<00:02,  3.34it/s]
 60%|██████    | 9/15 [00:04<00:01,  3.56it/s]
 67%|██████▋   | 10/15 [00:04<00:01,  3.74it/s]
 73%|███████▎  | 11/15 [00:04<00:01,  3.87it/s]
 80%|████████  | 12/15 [00:04<00:00,  3.96it/s]
 87%|████████▋ | 13/15 [00:05<00:00,  4.03it/s]
 93%|█████████▎| 14/15 [00:05<00:00,  4.09it/s]
100%|██████████| 15/15 [00:05<00:00,  4.12it/s]
100%|██████████| 15/15 [00:05<00:00,  2.59it/s]Testing there are 5924 samples in testset

[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  0%|          | 0/24 [00:00<?, ?it/s]
100%|██████████| 24/24 [00:00<00:00, 239.31it/s]
100%|██████████| 24/24 [00:00<00:00, 238.74it/s]

  0%|          | 0/15 [00:00<?, ?it/s]torch.Size([5924])
Test R @ 1:  0.6897366644159352
beat test acc, saving model ... 
epoch 65 G_lr 1.0799999999999998e-06 W_lr 2.1599999999999996e-06
Shuffling data
There are 100 unique labels
reshuffle took 0.027114391326904297 seconds
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  7%|▋         | 1/15 [00:02<00:36,  2.63s/it]
 13%|█▎        | 2/15 [00:03<00:19,  1.48s/it]
 20%|██        | 3/15 [00:03<00:10,  1.10it/s]
 27%|██▋       | 4/15 [00:03<00:07,  1.55it/s]
 33%|███▎      | 5/15 [00:04<00:05,  2.00it/s]
 40%|████      | 6/15 [00:04<00:03,  2.42it/s]
 47%|████▋     | 7/15 [00:04<00:02,  2.81it/s]
 53%|█████▎    | 8/15 [00:04<00:02,  3.13it/s]
 60%|██████    | 9/15 [00:04<00:01,  3.40it/s]
 67%|██████▋   | 10/15 [00:05<00:01,  3.61it/s]
 73%|███████▎  | 11/15 [00:05<00:01,  3.77it/s]
 80%|████████  | 12/15 [00:05<00:00,  3.89it/s]
 87%|████████▋ | 13/15 [00:05<00:00,  3.98it/s]
 93%|█████████▎| 14/15 [00:06<00:00,  4.04it/s]
100%|██████████| 15/15 [00:06<00:00,  4.09it/s]
100%|██████████| 15/15 [00:06<00:00,  2.29it/s]

  0%|          | 0/15 [00:00<?, ?it/s]epoch 66 G_lr 1.0799999999999998e-06 W_lr 2.1599999999999996e-06
Shuffling data
There are 100 unique labels
reshuffle took 0.028586149215698242 seconds
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  7%|▋         | 1/15 [00:02<00:35,  2.57s/it]
 13%|█▎        | 2/15 [00:02<00:15,  1.20s/it]
 20%|██        | 3/15 [00:03<00:09,  1.31it/s]
 27%|██▋       | 4/15 [00:03<00:06,  1.80it/s]
 33%|███▎      | 5/15 [00:03<00:04,  2.26it/s]
 40%|████      | 6/15 [00:03<00:03,  2.68it/s]
 47%|████▋     | 7/15 [00:04<00:02,  3.03it/s]
 53%|█████▎    | 8/15 [00:04<00:02,  3.31it/s]
 60%|██████    | 9/15 [00:04<00:01,  3.53it/s]
 67%|██████▋   | 10/15 [00:04<00:01,  3.71it/s]
 73%|███████▎  | 11/15 [00:04<00:01,  3.85it/s]
 80%|████████  | 12/15 [00:05<00:00,  3.95it/s]
 87%|████████▋ | 13/15 [00:05<00:00,  4.03it/s]
 93%|█████████▎| 14/15 [00:05<00:00,  4.08it/s]
100%|██████████| 15/15 [00:05<00:00,  4.13it/s]
100%|██████████| 15/15 [00:06<00:00,  2.47it/s]

  0%|          | 0/15 [00:00<?, ?it/s]epoch 67 G_lr 1.0799999999999998e-06 W_lr 2.1599999999999996e-06
Shuffling data
There are 100 unique labels
reshuffle took 0.027814388275146484 seconds
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  7%|▋         | 1/15 [00:02<00:32,  2.32s/it]
 13%|█▎        | 2/15 [00:02<00:14,  1.10s/it]
 20%|██        | 3/15 [00:02<00:08,  1.41it/s]
 27%|██▋       | 4/15 [00:03<00:05,  1.92it/s]
 33%|███▎      | 5/15 [00:03<00:04,  2.39it/s]
 40%|████      | 6/15 [00:03<00:03,  2.81it/s]
 47%|████▋     | 7/15 [00:03<00:02,  3.16it/s]
 53%|█████▎    | 8/15 [00:03<00:02,  3.44it/s]
 60%|██████    | 9/15 [00:04<00:01,  3.65it/s]
 67%|██████▋   | 10/15 [00:04<00:01,  3.81it/s]
 73%|███████▎  | 11/15 [00:04<00:01,  3.92it/s]
 80%|████████  | 12/15 [00:04<00:00,  4.01it/s]
 87%|████████▋ | 13/15 [00:05<00:00,  4.08it/s]
 93%|█████████▎| 14/15 [00:05<00:00,  4.13it/s]
100%|██████████| 15/15 [00:05<00:00,  4.15it/s]
100%|██████████| 15/15 [00:05<00:00,  2.60it/s]

  0%|          | 0/15 [00:00<?, ?it/s]epoch 68 G_lr 1.0799999999999998e-06 W_lr 2.1599999999999996e-06
Shuffling data
There are 100 unique labels
reshuffle took 0.028032302856445312 seconds
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  7%|▋         | 1/15 [00:02<00:39,  2.79s/it]
 13%|█▎        | 2/15 [00:03<00:16,  1.29s/it]
 20%|██        | 3/15 [00:03<00:09,  1.23it/s]
 27%|██▋       | 4/15 [00:03<00:06,  1.71it/s]
 33%|███▎      | 5/15 [00:03<00:04,  2.17it/s]
 40%|████      | 6/15 [00:03<00:03,  2.60it/s]
 47%|████▋     | 7/15 [00:04<00:02,  2.97it/s]
 53%|█████▎    | 8/15 [00:04<00:02,  3.27it/s]
 60%|██████    | 9/15 [00:04<00:01,  3.51it/s]
 67%|██████▋   | 10/15 [00:04<00:01,  3.70it/s]
 73%|███████▎  | 11/15 [00:05<00:01,  3.84it/s]
 80%|████████  | 12/15 [00:05<00:00,  3.95it/s]
 87%|████████▋ | 13/15 [00:05<00:00,  4.02it/s]
 93%|█████████▎| 14/15 [00:05<00:00,  4.08it/s]
100%|██████████| 15/15 [00:06<00:00,  4.11it/s]
100%|██████████| 15/15 [00:06<00:00,  2.39it/s]

  0%|          | 0/15 [00:00<?, ?it/s]epoch 69 G_lr 1.0799999999999998e-06 W_lr 2.1599999999999996e-06
Shuffling data
There are 100 unique labels
reshuffle took 0.027562379837036133 seconds
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  7%|▋         | 1/15 [00:01<00:27,  1.97s/it]
 13%|█▎        | 2/15 [00:02<00:12,  1.05it/s]
 20%|██        | 3/15 [00:02<00:07,  1.58it/s]
 27%|██▋       | 4/15 [00:02<00:05,  2.10it/s]
 33%|███▎      | 5/15 [00:02<00:03,  2.57it/s]
 40%|████      | 6/15 [00:03<00:03,  2.93it/s]
 47%|████▋     | 7/15 [00:03<00:02,  3.26it/s]
 53%|█████▎    | 8/15 [00:03<00:01,  3.51it/s]
 60%|██████    | 9/15 [00:03<00:01,  3.70it/s]
 67%|██████▋   | 10/15 [00:04<00:01,  3.85it/s]
 73%|███████▎  | 11/15 [00:04<00:01,  3.94it/s]
 80%|████████  | 12/15 [00:04<00:00,  4.01it/s]
 87%|████████▋ | 13/15 [00:04<00:00,  4.05it/s]
 93%|█████████▎| 14/15 [00:05<00:00,  4.10it/s]
100%|██████████| 15/15 [00:05<00:00,  4.12it/s]
100%|██████████| 15/15 [00:05<00:00,  2.73it/s]Testing there are 5924 samples in testset

[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  0%|          | 0/24 [00:00<?, ?it/s]
100%|██████████| 24/24 [00:00<00:00, 264.35it/s]

  0%|          | 0/15 [00:00<?, ?it/s]torch.Size([5924])
Test R @ 1:  0.6882174206617151
epoch 70 G_lr 1.0799999999999998e-06 W_lr 2.1599999999999996e-06
Shuffling data
There are 100 unique labels
reshuffle took 0.02657794952392578 seconds
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  7%|▋         | 1/15 [00:02<00:31,  2.23s/it]
 13%|█▎        | 2/15 [00:02<00:15,  1.20s/it]
 20%|██        | 3/15 [00:02<00:09,  1.31it/s]
 27%|██▋       | 4/15 [00:03<00:06,  1.80it/s]
 33%|███▎      | 5/15 [00:03<00:04,  2.26it/s]
 40%|████      | 6/15 [00:03<00:03,  2.68it/s]
 47%|████▋     | 7/15 [00:03<00:02,  3.03it/s]
 53%|█████▎    | 8/15 [00:04<00:02,  3.32it/s]
 60%|██████    | 9/15 [00:04<00:01,  3.55it/s]
 67%|██████▋   | 10/15 [00:04<00:01,  3.74it/s]
 73%|███████▎  | 11/15 [00:04<00:01,  3.88it/s]
 80%|████████  | 12/15 [00:05<00:00,  3.98it/s]
 87%|████████▋ | 13/15 [00:05<00:00,  4.05it/s]
 93%|█████████▎| 14/15 [00:05<00:00,  4.10it/s]
100%|██████████| 15/15 [00:05<00:00,  4.14it/s]
100%|██████████| 15/15 [00:05<00:00,  2.53it/s]

  0%|          | 0/15 [00:00<?, ?it/s]epoch 71 G_lr 1.0799999999999998e-06 W_lr 2.1599999999999996e-06
Shuffling data
There are 100 unique labels
reshuffle took 0.029503822326660156 seconds
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  7%|▋         | 1/15 [00:02<00:33,  2.39s/it]
 13%|█▎        | 2/15 [00:02<00:14,  1.12s/it]
 20%|██        | 3/15 [00:02<00:08,  1.39it/s]
 27%|██▋       | 4/15 [00:03<00:05,  1.89it/s]
 33%|███▎      | 5/15 [00:03<00:04,  2.36it/s]
 40%|████      | 6/15 [00:03<00:03,  2.77it/s]
 47%|████▋     | 7/15 [00:03<00:02,  3.13it/s]
 53%|█████▎    | 8/15 [00:04<00:02,  3.41it/s]
 60%|██████    | 9/15 [00:04<00:01,  3.63it/s]
 67%|██████▋   | 10/15 [00:04<00:01,  3.80it/s]
 73%|███████▎  | 11/15 [00:04<00:01,  3.92it/s]
 80%|████████  | 12/15 [00:04<00:00,  4.01it/s]
 87%|████████▋ | 13/15 [00:05<00:00,  4.07it/s]
 93%|█████████▎| 14/15 [00:05<00:00,  4.11it/s]
100%|██████████| 15/15 [00:05<00:00,  4.14it/s]
100%|██████████| 15/15 [00:05<00:00,  2.57it/s]

  0%|          | 0/15 [00:00<?, ?it/s]epoch 72 G_lr 1.0799999999999998e-06 W_lr 2.1599999999999996e-06
Shuffling data
There are 100 unique labels
reshuffle took 0.02790975570678711 seconds
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  7%|▋         | 1/15 [00:02<00:33,  2.40s/it]
 13%|█▎        | 2/15 [00:02<00:14,  1.13s/it]
 20%|██        | 3/15 [00:02<00:08,  1.37it/s]
 27%|██▋       | 4/15 [00:03<00:05,  1.87it/s]
 33%|███▎      | 5/15 [00:03<00:04,  2.32it/s]
 40%|████      | 6/15 [00:03<00:03,  2.74it/s]
 47%|████▋     | 7/15 [00:03<00:02,  3.09it/s]
 53%|█████▎    | 8/15 [00:04<00:02,  3.38it/s]
 60%|██████    | 9/15 [00:04<00:01,  3.61it/s]
 67%|██████▋   | 10/15 [00:04<00:01,  3.78it/s]
 73%|███████▎  | 11/15 [00:04<00:01,  3.91it/s]
 80%|████████  | 12/15 [00:05<00:00,  4.00it/s]
 87%|████████▋ | 13/15 [00:05<00:00,  4.06it/s]
 93%|█████████▎| 14/15 [00:05<00:00,  4.10it/s]
100%|██████████| 15/15 [00:05<00:00,  4.14it/s]
100%|██████████| 15/15 [00:05<00:00,  2.56it/s]

  0%|          | 0/15 [00:00<?, ?it/s]epoch 73 G_lr 1.0799999999999998e-06 W_lr 2.1599999999999996e-06
Shuffling data
There are 100 unique labels
reshuffle took 0.029863357543945312 seconds
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  7%|▋         | 1/15 [00:02<00:32,  2.30s/it]
 13%|█▎        | 2/15 [00:02<00:14,  1.15s/it]
 20%|██        | 3/15 [00:02<00:08,  1.36it/s]
 27%|██▋       | 4/15 [00:03<00:05,  1.86it/s]
 33%|███▎      | 5/15 [00:03<00:04,  2.33it/s]
 40%|████      | 6/15 [00:03<00:03,  2.74it/s]
 47%|████▋     | 7/15 [00:03<00:02,  3.10it/s]
 53%|█████▎    | 8/15 [00:04<00:02,  3.38it/s]
 60%|██████    | 9/15 [00:04<00:01,  3.60it/s]
 67%|██████▋   | 10/15 [00:04<00:01,  3.75it/s]
 73%|███████▎  | 11/15 [00:04<00:01,  3.86it/s]
 80%|████████  | 12/15 [00:05<00:00,  3.94it/s]
 87%|████████▋ | 13/15 [00:05<00:00,  4.00it/s]
 93%|█████████▎| 14/15 [00:05<00:00,  4.04it/s]
100%|██████████| 15/15 [00:05<00:00,  4.07it/s]
100%|██████████| 15/15 [00:05<00:00,  2.54it/s]

  0%|          | 0/15 [00:00<?, ?it/s]epoch 74 G_lr 1.0799999999999998e-06 W_lr 2.1599999999999996e-06
Shuffling data
There are 100 unique labels
reshuffle took 0.0298006534576416 seconds
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  7%|▋         | 1/15 [00:02<00:34,  2.48s/it]
 13%|█▎        | 2/15 [00:02<00:15,  1.16s/it]
 20%|██        | 3/15 [00:02<00:08,  1.34it/s]
 27%|██▋       | 4/15 [00:03<00:06,  1.82it/s]
 33%|███▎      | 5/15 [00:03<00:04,  2.29it/s]
 40%|████      | 6/15 [00:03<00:03,  2.70it/s]
 47%|████▋     | 7/15 [00:03<00:02,  3.05it/s]
 53%|█████▎    | 8/15 [00:04<00:02,  3.34it/s]
 60%|██████    | 9/15 [00:04<00:01,  3.56it/s]
 67%|██████▋   | 10/15 [00:04<00:01,  3.73it/s]
 73%|███████▎  | 11/15 [00:04<00:01,  3.86it/s]
 80%|████████  | 12/15 [00:05<00:00,  3.96it/s]
 87%|████████▋ | 13/15 [00:05<00:00,  4.02it/s]
 93%|█████████▎| 14/15 [00:05<00:00,  4.08it/s]
100%|██████████| 15/15 [00:05<00:00,  4.12it/s]
100%|██████████| 15/15 [00:05<00:00,  2.50it/s]Testing there are 5924 samples in testset

[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  0%|          | 0/24 [00:00<?, ?it/s]
100%|██████████| 24/24 [00:00<00:00, 252.13it/s]

  0%|          | 0/15 [00:00<?, ?it/s]torch.Size([5924])
Test R @ 1:  0.6856853477380148
epoch 75 G_lr 1.0799999999999998e-06 W_lr 2.1599999999999996e-06
Shuffling data
There are 100 unique labels
reshuffle took 0.02716827392578125 seconds
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  7%|▋         | 1/15 [00:02<00:33,  2.40s/it]
 13%|█▎        | 2/15 [00:02<00:14,  1.13s/it]
 20%|██        | 3/15 [00:02<00:08,  1.39it/s]
 27%|██▋       | 4/15 [00:03<00:05,  1.89it/s]
 33%|███▎      | 5/15 [00:03<00:04,  2.36it/s]
 40%|████      | 6/15 [00:03<00:03,  2.77it/s]
 47%|████▋     | 7/15 [00:03<00:02,  3.13it/s]
 53%|█████▎    | 8/15 [00:04<00:02,  3.41it/s]
 60%|██████    | 9/15 [00:04<00:01,  3.62it/s]
 67%|██████▋   | 10/15 [00:04<00:01,  3.79it/s]
 73%|███████▎  | 11/15 [00:04<00:01,  3.91it/s]
 80%|████████  | 12/15 [00:05<00:00,  3.98it/s]
 87%|████████▋ | 13/15 [00:05<00:00,  4.05it/s]
 93%|█████████▎| 14/15 [00:05<00:00,  4.10it/s]
100%|██████████| 15/15 [00:05<00:00,  4.11it/s]
100%|██████████| 15/15 [00:05<00:00,  2.56it/s]

  0%|          | 0/15 [00:00<?, ?it/s]epoch 76 G_lr 1.0799999999999998e-06 W_lr 2.1599999999999996e-06
Shuffling data
There are 100 unique labels
reshuffle took 0.029428482055664062 seconds
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  7%|▋         | 1/15 [00:02<00:31,  2.23s/it]
 13%|█▎        | 2/15 [00:02<00:17,  1.34s/it]
 20%|██        | 3/15 [00:03<00:10,  1.20it/s]
 27%|██▋       | 4/15 [00:03<00:06,  1.67it/s]
 33%|███▎      | 5/15 [00:03<00:04,  2.13it/s]
 40%|████      | 6/15 [00:03<00:03,  2.56it/s]
 47%|████▋     | 7/15 [00:04<00:02,  2.94it/s]
 53%|█████▎    | 8/15 [00:04<00:02,  3.26it/s]
 60%|██████    | 9/15 [00:04<00:01,  3.51it/s]
 67%|██████▋   | 10/15 [00:04<00:01,  3.70it/s]
 73%|███████▎  | 11/15 [00:05<00:01,  3.84it/s]
 80%|████████  | 12/15 [00:05<00:00,  3.95it/s]
 87%|████████▋ | 13/15 [00:05<00:00,  4.02it/s]
 93%|█████████▎| 14/15 [00:05<00:00,  4.08it/s]
100%|██████████| 15/15 [00:06<00:00,  4.12it/s]
100%|██████████| 15/15 [00:06<00:00,  2.43it/s]

  0%|          | 0/15 [00:00<?, ?it/s]epoch 77 G_lr 1.0799999999999998e-06 W_lr 2.1599999999999996e-06
Shuffling data
There are 100 unique labels
reshuffle took 0.028232336044311523 seconds
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  7%|▋         | 1/15 [00:02<00:38,  2.72s/it]
 13%|█▎        | 2/15 [00:02<00:16,  1.26s/it]
 20%|██        | 3/15 [00:03<00:09,  1.26it/s]
 27%|██▋       | 4/15 [00:03<00:06,  1.74it/s]
 33%|███▎      | 5/15 [00:03<00:04,  2.21it/s]
 40%|████      | 6/15 [00:03<00:03,  2.64it/s]
 47%|████▋     | 7/15 [00:04<00:02,  3.00it/s]
 53%|█████▎    | 8/15 [00:04<00:02,  3.30it/s]
 60%|██████    | 9/15 [00:04<00:01,  3.54it/s]
 67%|██████▋   | 10/15 [00:04<00:01,  3.71it/s]
 73%|███████▎  | 11/15 [00:05<00:01,  3.85it/s]
 80%|████████  | 12/15 [00:05<00:00,  3.94it/s]
 87%|████████▋ | 13/15 [00:05<00:00,  4.01it/s]
 93%|█████████▎| 14/15 [00:05<00:00,  4.06it/s]
100%|██████████| 15/15 [00:06<00:00,  4.10it/s]
100%|██████████| 15/15 [00:06<00:00,  2.42it/s]

  0%|          | 0/15 [00:00<?, ?it/s]epoch 78 G_lr 1.0799999999999998e-06 W_lr 2.1599999999999996e-06
Shuffling data
There are 100 unique labels
reshuffle took 0.028572559356689453 seconds
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  7%|▋         | 1/15 [00:02<00:33,  2.39s/it]
 13%|█▎        | 2/15 [00:02<00:14,  1.13s/it]
 20%|██        | 3/15 [00:02<00:08,  1.38it/s]
 27%|██▋       | 4/15 [00:03<00:05,  1.88it/s]
 33%|███▎      | 5/15 [00:03<00:04,  2.36it/s]
 40%|████      | 6/15 [00:03<00:03,  2.77it/s]
 47%|████▋     | 7/15 [00:03<00:02,  3.13it/s]
 53%|█████▎    | 8/15 [00:04<00:02,  3.41it/s]
 60%|██████    | 9/15 [00:04<00:01,  3.63it/s]
 67%|██████▋   | 10/15 [00:04<00:01,  3.80it/s]
 73%|███████▎  | 11/15 [00:04<00:01,  3.92it/s]
 80%|████████  | 12/15 [00:05<00:00,  4.01it/s]
 87%|████████▋ | 13/15 [00:05<00:00,  4.07it/s]
 93%|█████████▎| 14/15 [00:05<00:00,  4.11it/s]
100%|██████████| 15/15 [00:05<00:00,  4.15it/s]
100%|██████████| 15/15 [00:05<00:00,  2.57it/s]

  0%|          | 0/15 [00:00<?, ?it/s]epoch 79 G_lr 1.0799999999999998e-06 W_lr 2.1599999999999996e-06
Shuffling data
There are 100 unique labels
reshuffle took 0.02821063995361328 seconds
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  7%|▋         | 1/15 [00:01<00:26,  1.92s/it]
 13%|█▎        | 2/15 [00:02<00:14,  1.10s/it]
 20%|██        | 3/15 [00:02<00:08,  1.42it/s]
 27%|██▋       | 4/15 [00:02<00:05,  1.92it/s]
 33%|███▎      | 5/15 [00:03<00:04,  2.38it/s]
 40%|████      | 6/15 [00:03<00:03,  2.79it/s]
 47%|████▋     | 7/15 [00:03<00:02,  3.13it/s]
 53%|█████▎    | 8/15 [00:03<00:02,  3.41it/s]
 60%|██████    | 9/15 [00:04<00:01,  3.62it/s]
 67%|██████▋   | 10/15 [00:04<00:01,  3.78it/s]
 73%|███████▎  | 11/15 [00:04<00:01,  3.89it/s]
 80%|████████  | 12/15 [00:04<00:00,  3.98it/s]
 87%|████████▋ | 13/15 [00:05<00:00,  4.05it/s]
 93%|█████████▎| 14/15 [00:05<00:00,  4.10it/s]
100%|██████████| 15/15 [00:05<00:00,  4.13it/s]
100%|██████████| 15/15 [00:05<00:00,  2.65it/s]Testing there are 5924 samples in testset

[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  0%|          | 0/24 [00:00<?, ?it/s]
100%|██████████| 24/24 [00:00<00:00, 240.70it/s]

  0%|          | 0/47 [00:00<?, ?it/s]torch.Size([5924])
Test R @ 1:  0.6868669817690749
Done. Best acc was:  0.6897366644159352
Running final evaluation ... 
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)

  2%|▏         | 1/47 [00:02<02:03,  2.68s/it]
  6%|▋         | 3/47 [00:02<00:33,  1.31it/s]
 11%|█         | 5/47 [00:03<00:17,  2.41it/s]
 15%|█▍        | 7/47 [00:03<00:11,  3.62it/s]
 19%|█▉        | 9/47 [00:03<00:07,  4.94it/s]
 23%|██▎       | 11/47 [00:03<00:05,  6.20it/s]
 28%|██▊       | 13/47 [00:03<00:04,  7.38it/s]
 32%|███▏      | 15/47 [00:03<00:03,  8.50it/s]
 36%|███▌      | 17/47 [00:04<00:03,  9.27it/s]
 40%|████      | 19/47 [00:04<00:02,  9.90it/s]
 45%|████▍     | 21/47 [00:04<00:02, 10.59it/s]
 49%|████▉     | 23/47 [00:04<00:02, 10.87it/s]
 53%|█████▎    | 25/47 [00:04<00:01, 11.05it/s]
 57%|█████▋    | 27/47 [00:04<00:01, 11.25it/s]
 62%|██████▏   | 29/47 [00:05<00:01, 11.62it/s]
 66%|██████▌   | 31/47 [00:05<00:01, 11.89it/s]
 70%|███████   | 33/47 [00:05<00:01, 12.08it/s]
 74%|███████▍  | 35/47 [00:05<00:00, 12.22it/s]
 79%|███████▊  | 37/47 [00:05<00:00, 12.32it/s]
 83%|████████▎ | 39/47 [00:05<00:00, 12.33it/s]
 87%|████████▋ | 41/47 [00:06<00:00, 12.39it/s]
 91%|█████████▏| 43/47 [00:06<00:00, 12.43it/s]
 96%|█████████▌| 45/47 [00:06<00:00, 12.47it/s]
100%|██████████| 47/47 [00:06<00:00, 13.88it/s]
100%|██████████| 47/47 [00:06<00:00,  7.15it/s]

  0%|          | 0/24 [00:00<?, ?it/s]
100%|██████████| 24/24 [00:00<00:00, 234.30it/s]
100%|██████████| 24/24 [00:00<00:00, 233.87it/s]
torch.Size([5924])
Test R @ 1:  0.6868669817690749
R @ 1: 68.68669817690748
R @ 2: 79.35516542876435
R @ 4: 86.64753544902094
R @ 8: 91.54287643484132
